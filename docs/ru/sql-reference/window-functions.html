<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ru/sql-reference/window-functions/index">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Window Functions | ClickHouse Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://clickhouse.com/docs/img/logo.png"><meta data-rh="true" name="twitter:image" content="https://clickhouse.com/docs/img/logo.png"><meta data-rh="true" property="og:url" content="https://clickhouse.com/docs/ru/sql-reference/window-functions"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Window Functions | ClickHouse Docs"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://clickhouse.com/docs/ru/sql-reference/window-functions"><link data-rh="true" rel="alternate" href="https://clickhouse.com/docs/ru/sql-reference/window-functions" hreflang="en"><link data-rh="true" rel="alternate" href="https://clickhouse.com/docs/ru/sql-reference/window-functions" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://62VCH2MD74-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/docs/knowledgebase/rss.xml" title="ClickHouse Knowledge Base Feed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/knowledgebase/atom.xml" title="ClickHouse Knowledge Base Feed Atom Feed">
<link rel="alternate" type="application/json" href="/docs/knowledgebase/feed.json" title="ClickHouse Knowledge Base Feed JSON Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KF1LLRTQ5Q"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KF1LLRTQ5Q",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="ClickHouse Docs" href="/docs/opensearch.xml">





<script src="/docs/js/analytics.js"></script><link rel="stylesheet" href="/docs/assets/css/styles.babd5c95.css">
<link rel="preload" href="/docs/assets/js/runtime~main.4296040c.js" as="script">
<link rel="preload" href="/docs/assets/js/main.299dbf94.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navBar_gvJn"><div class="navbarHeaderContainer_rccn navbar-header"><div class="navbar__inner navbarInner_W6bg"><div class="navbar__items"><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs/img/ch_logo_docs.svg" alt="ClickHouse" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/ch_logo_docs_dark.svg" alt="ClickHouse" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><div class="navbarItemsList_uIZ2 navbar-items-list"><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link ch-menu">Product</a><ul class="dropdown__menu"><li><a href="https://clickhouse.com/clickhouse" target="_blank" rel="noopener noreferrer" class="dropdown__link">ClickHouse</a></li><li><a href="https://clickhouse.com/cloud" target="_blank" rel="noopener noreferrer" class="dropdown__link">ClickHouse Cloud</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link ch-menu">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/en/intro">Docs</a></li><li><a href="https://clickhouse.com/learn" target="_blank" rel="noopener noreferrer" class="dropdown__link">ClickHouse Academy</a></li><li><a href="https://clickhouse.com/company/news-events" target="_blank" rel="noopener noreferrer" class="dropdown__link">Upcoming training</a></li><li><a href="https://clickhouse.com/blog" target="_blank" rel="noopener noreferrer" class="dropdown__link">Blog</a></li><li><a href="https://clickhouse.com/support/program" target="_blank" rel="noopener noreferrer" class="dropdown__link">Support Program</a></li></ul></div><a href="https://clickhouse.com/customer-stories" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link ch-menu">Use Cases</a><a href="https://clickhouse.com/pricing" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link ch-menu">Pricing</a></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item">
                <div class="nav-items-btns">
                  <a href="https://clickhouse.cloud/signIn" class="sign-in navbar__item navbar__link ch-menu">
                    Sign in
                  </a>
                  <a href="https://clickhouse.cloud/signUp" class="click-button-anchor">
                    <button class="click-button primary-btn">Get started</button>
                  </a>
                </div></div><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button></div></div><div class="secondary-nav--items secondaryMenu_iuff"><div class="scrollableElement_Qqzp secondaryMenuLeft_tFZR secondary-nav--items-left"><a class="navbar__item navbar__link ch-menu" href="/docs/en/intro">Docs</a><a class="navbar__item navbar__link ch-menu" href="/docs/en/cloud/overview">Cloud</a><a class="navbar__item navbar__link ch-menu" href="/docs/en/sql-reference">SQL Reference</a><a class="navbar__item navbar__link ch-menu" href="/docs/knowledgebase">Knowledge Base</a></div><div class="secondaryMenuRight__9m4 secondary-nav--items-right"><div class="navbar__item dropdown dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg width="14" height="13" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M6.95 12.6496L9.75 5.26628H11.0333L13.8333 12.6496H12.55L11.9 10.7663H8.91667L8.25 12.6496H6.95ZM9.28333 9.69961H11.5L10.4167 6.64961H10.3667L9.28333 9.69961ZM2.08333 10.7996L1.21667 9.93294L4.33333 6.83294C3.94444 6.39961 3.60556 5.95228 3.31667 5.49094C3.02778 5.03005 2.77222 4.54405 2.55 4.03294H3.83333C4.02222 4.41072 4.22222 4.74672 4.43333 5.04094C4.64444 5.33561 4.89444 5.64405 5.18333 5.96628C5.63889 5.47739 6.01667 4.97472 6.31667 4.45828C6.61667 3.94139 6.86667 3.3885 7.06667 2.79961H0.25V1.58294H4.55V0.349609H5.78333V1.58294H10.0833V2.79961H8.3C8.07778 3.53294 7.78333 4.24116 7.41667 4.92428C7.05 5.60783 6.59444 6.25516 6.05 6.86628L7.53333 8.36628L7.06667 9.63294L5.16667 7.73294L2.08333 10.7996Z" fill="currentColor"/>
</svg></a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/en/intro">English</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/ru">Russian</a></li><li><a class="dropdown__link" href="/docs/zh">Chinese</a></li></ul></div><button class="colorModeButton_hk25 navbar-color-toggle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"></path></svg><span>dark Mode</span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_W2AM"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage_qMb8"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_mhZE"><div class="sidebarSearchContainer_Lwc8"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Y1UP"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/ru">Что такое ClickHouse</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/введение">Введение</a><button aria-label="Toggle the collapsible sidebar category &#x27;Введение&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/ru/getting-started">Начало работы</a><button aria-label="Toggle the collapsible sidebar category &#x27;Начало работы&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/ru/interfaces">Интерфейсы</a><button aria-label="Toggle the collapsible sidebar category &#x27;Интерфейсы&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/engines">Engines</a><button aria-label="Toggle the collapsible sidebar category &#x27;Engines&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/ru/sql-reference">Справка по SQL</a><button aria-label="Toggle the collapsible sidebar category &#x27;Справка по SQL&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ru/sql-reference/statements">Выражения</a><button aria-label="Toggle the collapsible sidebar category &#x27;Выражения&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ru/sql-reference/syntax">Синтаксис</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ru/sql-reference/distributed-ddl">Распределенные DDL запросы</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ru/sql-reference/functions">Функции</a><button aria-label="Toggle the collapsible sidebar category &#x27;Функции&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ru/sql-reference/aggregate-functions">Агрегатные функции</a><button aria-label="Toggle the collapsible sidebar category &#x27;Агрегатные функции&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ru/sql-reference/table-functions">Табличные функции</a><button aria-label="Toggle the collapsible sidebar category &#x27;Табличные функции&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ru/sql-reference/dictionaries">Словари</a><button aria-label="Toggle the collapsible sidebar category &#x27;Словари&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ru/sql-reference/data-types">Типы данных</a><button aria-label="Toggle the collapsible sidebar category &#x27;Типы данных&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/ru/sql-reference/operators">Операторы</a><button aria-label="Toggle the collapsible sidebar category &#x27;Операторы&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ru/sql-reference/ansi">ANSI Compatibility</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ru/sql-reference/window-functions">Window Functions</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/ru/guides">Руководства</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/ru/operations">Эксплуатация</a><button aria-label="Toggle the collapsible sidebar category &#x27;Эксплуатация&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/инструкция-для-разработчиков">Инструкция для разработчиков</a><button aria-label="Toggle the collapsible sidebar category &#x27;Инструкция для разработчиков&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/ru/commercial">Коммерческие услуги</a><button aria-label="Toggle the collapsible sidebar category &#x27;Коммерческие услуги&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/ru/whats-new">What&#x27;s New</a><button aria-label="Toggle the collapsible sidebar category &#x27;What&#x27;s New&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/ru/faq">F.A.Q.</a><button aria-label="Toggle the collapsible sidebar category &#x27;F.A.Q.&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menuListItemCollapsed_i9wL menu__list-item-collapsible" data-link="true"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/ru/about-us">About Us</a><button aria-label="Toggle the collapsible sidebar category &#x27;About Us&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_RiV8"><div class="container padding-top--md padding-bottom--lg main-content-wrapper"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><div class="theme-doc-markdown markdown"><header><h1>Window Functions</h1></header><p>ClickHouse supports the standard grammar for defining windows and window functions. The following features are currently supported:</p><table><thead><tr><th>Feature</th><th>Support or workaround</th></tr></thead><tbody><tr><td>ad hoc window specification (<code>count(*) over (partition by id order by time desc)</code>)</td><td>supported</td></tr><tr><td>expressions involving window functions, e.g. <code>(count(*) over ()) / 2)</code></td><td>supported</td></tr><tr><td><code>WINDOW</code> clause (<code>select ... from table window w as (partition by id)</code>)</td><td>supported</td></tr><tr><td><code>ROWS</code> frame</td><td>supported</td></tr><tr><td><code>RANGE</code> frame</td><td>supported, the default</td></tr><tr><td><code>INTERVAL</code> syntax for <code>DateTime</code> <code>RANGE OFFSET</code> frame</td><td>not supported, specify the number of seconds instead (<code>RANGE</code> works with any numeric type).</td></tr><tr><td><code>GROUPS</code> frame</td><td>not supported</td></tr><tr><td>Calculating aggregate functions over a frame (<code>sum(value) over (order by time)</code>)</td><td>all aggregate functions are supported</td></tr><tr><td><code>rank()</code>, <code>dense_rank()</code>, <code>row_number()</code></td><td>supported</td></tr><tr><td><code>lag/lead(value, offset)</code></td><td>Not supported. Workarounds:</td></tr><tr><td></td><td>1) replace with <code>any(value) over (.... rows between &lt;offset&gt; preceding and &lt;offset&gt; preceding)</code>, or <code>following</code> for <code>lead</code></td></tr><tr><td></td><td>2) use <code>lagInFrame/leadInFrame</code>, which are analogous, but respect the window frame. To get behavior identical to <code>lag/lead</code>, use <code>rows between unbounded preceding and unbounded following</code></td></tr><tr><td>ntile(buckets)</td><td>Supported. Specify window like, (partition by x order by y rows between unbounded preceding and unounded following).</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="clickhouse-specific-window-functions">ClickHouse-specific Window Functions<a href="#clickhouse-specific-window-functions" class="hash-link" aria-label="Direct link to ClickHouse-specific Window Functions" title="Direct link to ClickHouse-specific Window Functions">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nonnegativederivativemetric_column-timestamp_column-interval-x-units">nonNegativeDerivative(metric_column, timestamp_column<!-- -->[, INTERVAL X UNITS]<!-- -->)<a href="#nonnegativederivativemetric_column-timestamp_column-interval-x-units" class="hash-link" aria-label="Direct link to nonnegativederivativemetric_column-timestamp_column-interval-x-units" title="Direct link to nonnegativederivativemetric_column-timestamp_column-interval-x-units">​</a></h3><p>Finds non-negative derivative for given <code>metric_column</code> by <code>timestamp_column</code>.
<code>INTERVAL</code> can be omitted, default is <code>INTERVAL 1 SECOND</code>.
The computed value is the following for each row:</p><ul><li><code>0</code> for 1st row,</li><li>${metric<em>i - metric</em>{i-1} \over timestamp<em>i - timestamp</em>{i-1}}  * interval$ for $i_th$ row.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="github-issues">GitHub Issues<a href="#github-issues" class="hash-link" aria-label="Direct link to GitHub Issues" title="Direct link to GitHub Issues">​</a></h3><p>The roadmap for the initial support of window functions is <a href="https://github.com/ClickHouse/ClickHouse/issues/18097" target="_blank" rel="noopener noreferrer">in this issue</a>.</p><p>All GitHub issues related to window funtions have the <a href="https://github.com/ClickHouse/ClickHouse/labels/comp-window-functions" target="_blank" rel="noopener noreferrer">comp-window-functions</a> tag.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tests">Tests<a href="#tests" class="hash-link" aria-label="Direct link to Tests" title="Direct link to Tests">​</a></h3><p>These tests contain the examples of the currently supported grammar:</p><p><a href="https://github.com/ClickHouse/ClickHouse/blob/master/tests/performance/window_functions.xml" target="_blank" rel="noopener noreferrer">https://github.com/ClickHouse/ClickHouse/blob/master/tests/performance/window_functions.xml</a></p><p><a href="https://github.com/ClickHouse/ClickHouse/blob/master/tests/queries/0_stateless/01591_window_functions.sql" target="_blank" rel="noopener noreferrer">https://github.com/ClickHouse/ClickHouse/blob/master/tests/queries/0_stateless/01591_window_functions.sql</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="postgres-docs">Postgres Docs<a href="#postgres-docs" class="hash-link" aria-label="Direct link to Postgres Docs" title="Direct link to Postgres Docs">​</a></h3><p><a href="https://www.postgresql.org/docs/current/sql-select.html#SQL-WINDOW" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/docs/current/sql-select.html#SQL-WINDOW</a></p><p><a href="https://www.postgresql.org/docs/devel/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/docs/devel/sql-expressions.html#SYNTAX-WINDOW-FUNCTIONS</a></p><p><a href="https://www.postgresql.org/docs/devel/functions-window.html" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/docs/devel/functions-window.html</a></p><p><a href="https://www.postgresql.org/docs/devel/tutorial-window.html" target="_blank" rel="noopener noreferrer">https://www.postgresql.org/docs/devel/tutorial-window.html</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mysql-docs">MySQL Docs<a href="#mysql-docs" class="hash-link" aria-label="Direct link to MySQL Docs" title="Direct link to MySQL Docs">​</a></h3><p><a href="https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html</a></p><p><a href="https://dev.mysql.com/doc/refman/8.0/en/window-functions-usage.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/window-functions-usage.html</a></p><p><a href="https://dev.mysql.com/doc/refman/8.0/en/window-functions-frames.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/window-functions-frames.html</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="syntax">Syntax<a href="#syntax" class="hash-link" aria-label="Direct link to Syntax" title="Direct link to Syntax">​</a></h2><div class="language-text codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">aggregate_function (column_name)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  OVER ([[PARTITION BY grouping_column] [ORDER BY sorting_column] </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        [ROWS or RANGE expression_to_bound_rows_withing_the_group]] | [window_name])</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">FROM table_name</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">WINDOW window_name as ([[PARTITION BY grouping_column] [ORDER BY sorting_column])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>PARTITION BY</code> - defines how to break a resultset into groups.</li><li><code>ORDER BY</code> - defines how to order rows inside the group during calculation aggregate_function.</li><li><code>ROWS or RANGE</code> - defines bounds of a frame, aggregate_function is calculated within a frame.</li><li><code>WINDOW</code> - allows to reuse a window definition with multiple exressions.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="functions">Functions<a href="#functions" class="hash-link" aria-label="Direct link to Functions" title="Direct link to Functions">​</a></h3><p>These functions can be used only as a window function.</p><p><code>row_number()</code> -	Number the current row within its partition starting from 1.
<code>first_value(x)</code> -	Return the first non-NULL value evaluated within its ordered frame.
<code>last_value(x)</code> -	Return the last non-NULL value evaluated within its ordered frame.
<code>nth_value(x, offset)</code> - Return the first non-NULL value evaluated against the nth row (offset) in its ordered frame.
<code>rank()</code> -	Rank the current row within its partition with gaps.
<code>dense_rank()</code>	- Rank the current row within its partition without gaps.
<code>lagInFrame(x)</code> - Return a value evaluated at the row that is at a specified physical offset row before the current row within the ordered frame.
<code>leadInFrame(x)</code> - Return a value evaluated at the row that is offset rows after the current row within the ordered frame.</p><div class="language-text codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">      PARTITION</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─────────────────┐  &lt;-- UNBOUNDED PRECEDING (BEGINNING of the PARTITION)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│                 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│                 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│=================│  &lt;-- N PRECEDING  &lt;─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│      N ROWS     │                     │  F</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│  Before CURRENT │                     │  R</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│~~~~~~~~~~~~~~~~~│  &lt;-- CURRENT ROW    │  A</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│     M ROWS      │                     │  M</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│   After CURRENT │                     │  E</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│=================│  &lt;-- M FOLLOWING  &lt;─┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│                 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│                 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└─────────────────┘  &lt;--- UNBOUNDED FOLLOWING (END of the PARTITION)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h2><div class="language-sql codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> wf_partition</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">part_key</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> UInt64</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">value</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> UInt64</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">order</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> UInt64    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Memory</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> wf_partition FORMAT </span><span class="token keyword" style="color:rgb(86, 156, 214)">Values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_partition</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─part_key─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain">─┬─frame_values─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │   </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">┐   </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │    │  </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">st </span><span class="token keyword" style="color:rgb(86, 156, 214)">group</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │   </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">┘ </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │   </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">  </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">nd </span><span class="token keyword" style="color:rgb(86, 156, 214)">group</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │   </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">  </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token plain">d </span><span class="token keyword" style="color:rgb(86, 156, 214)">group</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴───────┴───────┴──────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-sql codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">part_key</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> UInt64</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">value</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> UInt64</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">order</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> UInt64</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Memory</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> wf_frame FORMAT </span><span class="token keyword" style="color:rgb(86, 156, 214)">Values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- frame is bounded by bounds of a partition (BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         </span><span class="token keyword" style="color:rgb(86, 156, 214)">Rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">UNBOUNDED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">UNBOUNDED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">FOLLOWING</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─part_key─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain">─┬─frame_values─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴───────┴───────┴──────────────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- short form - no bound expression, no order by</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─part_key─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain">─┬─frame_values─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴───────┴───────┴──────────────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- frame is bounded by the beggining of a partition and the current row</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">Rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">UNBOUNDED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ROW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─part_key─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain">─┬─frame_values─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴───────┴───────┴──────────────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- short form (frame is bounded by the beggining of a partition and the current row)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─part_key─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain">─┬─frame_values─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴───────┴───────┴──────────────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- frame is bounded by the beggining of a partition and the current row, but order is backward</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">DESC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─part_key─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain">─┬─frame_values─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴───────┴───────┴──────────────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- sliding frame - 1 PRECEDING ROW AND CURRENT ROW</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">Rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ROW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─part_key─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain">─┬─frame_values─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴───────┴───────┴──────────────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- sliding frame - Rows BETWEEN 1 PRECEDING AND UNBOUNDED FOLLOWING </span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">Rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">UNBOUNDED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">FOLLOWING</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─part_key─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain">─┬─frame_values─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴───────┴───────┴──────────────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- row_number does not respect the frame, so rn_1 = rn_2 = rn_3 != rn_4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    row_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> rn_1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">sum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> rn_2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    row_number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w2 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> rn_3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">sum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w2 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> rn_4</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">WINDOW</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">DESC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    w2 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">DESC</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                   </span><span class="token keyword" style="color:rgb(86, 156, 214)">Rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ROW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─part_key─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain">─┬─frame_values─┬─rn_1─┬─rn_2─┬─rn_3─┬─rn_4─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">  │    </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">    │    </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │    </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │    </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│        </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │    </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴───────┴───────┴──────────────┴──────┴──────┴──────┴──────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- first_value and last_value respect the frame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values_1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    first_value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> first_value_1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    last_value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> last_value_1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w2 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values_2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    first_value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w2 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> first_value_2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    last_value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w2 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> last_value_2</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">WINDOW</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    w2 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ROW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─frame_values_1─┬─first_value_1─┬─last_value_1─┬─frame_values_2─┬─first_value_2─┬─last_value_2─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">            │             </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">            │             </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │             </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │             </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │             </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │             </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │             </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │             </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">    │             </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │             </span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────────┴───────────────┴──────────────┴────────────────┴───────────────┴──────────────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- second value within the frame</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values_1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    nth_value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> second_value</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">WINDOW w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ROW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─frame_values_1─┬─second_value─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">            │            </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │            </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │            </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │            </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │            </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────────┴──────────────┘</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">-- second value within the frame + Null for missing values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    groupArray</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> frame_values_1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    nth_value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">toNullable</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> second_value</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> wf_frame</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">WINDOW w1 </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">order</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ROW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    part_key </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─frame_values_1─┬─second_value─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">            │         ᴺᵁᴸᴸ │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">          │            </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">        │            </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │            </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ </span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">5</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">      │            </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────────┴──────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="real-world-examples">Real world examples<a href="#real-world-examples" class="hash-link" aria-label="Direct link to Real world examples" title="Direct link to Real world examples">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="maximumtotal-salary-per-department">Maximum/total salary per department.<a href="#maximumtotal-salary-per-department" class="hash-link" aria-label="Direct link to Maximum/total salary per department." title="Direct link to Maximum/total salary per department.">​</a></h3><div class="language-sql codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> employees</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">department</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">employee_name</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">salary</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Float</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Memory</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> employees FORMAT </span><span class="token keyword" style="color:rgb(86, 156, 214)">Values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Finance&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Jonh&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Finance&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Joan&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">210</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Finance&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Jean&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">505</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;IT&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Tim&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;IT&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Anna&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;IT&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;Elen&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    department</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    employee_name </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> emp</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    salary</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    max_salary_per_dep</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    total_salary_per_dep</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">round</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">salary </span><span class="token operator" style="color:rgb(212, 212, 212)">/</span><span class="token plain"> total_salary_per_dep</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">share_per_dep(%)</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        department</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        employee_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        salary</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">max</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">salary</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> wndw </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> max_salary_per_dep</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token function" style="color:rgb(220, 220, 170)">sum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">salary</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> wndw </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> total_salary_per_dep</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> employees</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    WINDOW wndw </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> department</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">          </span><span class="token keyword" style="color:rgb(86, 156, 214)">rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">UNBOUNDED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">UNBOUNDED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">FOLLOWING</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        department </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        employee_name </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─department─┬─emp──┬─salary─┬─max_salary_per_dep─┬─total_salary_per_dep─┬─share_per_dep</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">%</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ Finance    │ Jean │    </span><span class="token number" style="color:rgb(181, 206, 168)">505</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">505</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(181, 206, 168)">915</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">55.19</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ Finance    │ Joan │    </span><span class="token number" style="color:rgb(181, 206, 168)">210</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">505</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(181, 206, 168)">915</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">22.95</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ Finance    │ Jonh │    </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">505</span><span class="token plain"> │                  </span><span class="token number" style="color:rgb(181, 206, 168)">915</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">21.86</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ IT         │ Anna │    </span><span class="token number" style="color:rgb(181, 206, 168)">300</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token plain"> │                 </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(181, 206, 168)">30</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ IT         │ Elen │    </span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token plain"> │                 </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(181, 206, 168)">50</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ IT         │ Tim  │    </span><span class="token number" style="color:rgb(181, 206, 168)">200</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">500</span><span class="token plain"> │                 </span><span class="token number" style="color:rgb(181, 206, 168)">1000</span><span class="token plain"> │               </span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴──────┴────────┴────────────────────┴──────────────────────┴──────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cumulative-sum">Cumulative sum.<a href="#cumulative-sum" class="hash-link" aria-label="Direct link to Cumulative sum." title="Direct link to Cumulative sum.">​</a></h3><div class="language-sql codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> warehouse</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">item</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">ts</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">DateTime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">value</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Float</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Memory</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">INTO</span><span class="token plain"> warehouse </span><span class="token keyword" style="color:rgb(86, 156, 214)">VALUES</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sku38&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sku38&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-02-01&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sku38&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-03-01&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sku1&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sku1&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-02-01&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;sku1&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-03-01&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    item</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">sum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> item </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> ts </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> stock_balance</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> warehouse</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    item </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─item──┬──────────────────ts─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─stock_balance─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ sku1  │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ sku1  │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ sku1  │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">03</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ sku38 │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ sku38 │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"> │            </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ sku38 │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">03</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">4</span><span class="token plain"> │             </span><span class="token number" style="color:rgb(181, 206, 168)">6</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└───────┴─────────────────────┴───────┴───────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="moving--sliding-average-per-3-rows">Moving / Sliding Average (per 3 rows)<a href="#moving--sliding-average-per-3-rows" class="hash-link" aria-label="Direct link to Moving / Sliding Average (per 3 rows)" title="Direct link to Moving / Sliding Average (per 3 rows)">​</a></h3><div class="language-sql codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> sensors</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">metric</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">ts</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">DateTime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">value</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Float</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Memory</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">into</span><span class="token plain"> sensors </span><span class="token keyword" style="color:rgb(86, 156, 214)">values</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cpu_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 00:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cpu_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 00:00:01&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">77</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cpu_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 00:00:02&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">93</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cpu_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 00:00:03&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cpu_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 00:00:04&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cpu_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 00:00:05&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cpu_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 00:00:06&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;cpu_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 00:00:07&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    metric</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">avg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> metric </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> ts </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Rows</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ROW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">         </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> moving_avg_temp</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> sensors</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    metric </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─metric───┬──────────────────ts─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬───moving_avg_temp─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">77</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">82</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">93</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(181, 206, 168)">85.66666666666667</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">03</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │ </span><span class="token number" style="color:rgb(181, 206, 168)">85.66666666666667</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">04</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">89</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">05</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">06</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">07</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴─────────────────────┴───────┴───────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="moving--sliding-average-per-10-seconds">Moving / Sliding Average (per 10 seconds)<a href="#moving--sliding-average-per-10-seconds" class="hash-link" aria-label="Direct link to Moving / Sliding Average (per 10 seconds)" title="Direct link to Moving / Sliding Average (per 10 seconds)">​</a></h3><div class="language-sql codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    metric</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">avg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> metric </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> ts</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      Range </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ROW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> moving_avg_10_seconds_temp</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> sensors</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    metric </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─metric───┬──────────────────ts─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─moving_avg_10_seconds_temp─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                         </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">77</span><span class="token plain"> │                         </span><span class="token number" style="color:rgb(181, 206, 168)">77</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">93</span><span class="token plain"> │                         </span><span class="token number" style="color:rgb(181, 206, 168)">93</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">03</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">30</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                         </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">04</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">40</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                         </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">05</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">50</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                         </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">06</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                         </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ cpu_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">07</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │                         </span><span class="token number" style="color:rgb(181, 206, 168)">87</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────┴─────────────────────┴───────┴────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="moving--sliding-average-per-10-days">Moving / Sliding Average (per 10 days)<a href="#moving--sliding-average-per-10-days" class="hash-link" aria-label="Direct link to Moving / Sliding Average (per 10 days)" title="Direct link to Moving / Sliding Average (per 10 days)">​</a></h3><p>Temperature is stored with second precision, but using <code>Range</code> and <code>ORDER BY toDate(ts)</code> we form a frame with the size of 10 units, and because of <code>toDate(ts)</code> the unit is a day.</p><div class="language-sql codeBlockContainer_APcc theme-code-block"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">TABLE</span><span class="token plain"> sensors</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">metric</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">ts</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">DateTime</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token identifier">value</span><span class="token identifier punctuation" style="color:rgb(212, 212, 212)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">Float</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> Memory</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">into</span><span class="token plain"> sensors </span><span class="token keyword" style="color:rgb(86, 156, 214)">values</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 00:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-01 12:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-02 11:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-01-02 12:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">                          </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-02-01 10:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-02-01 12:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-02-10 12:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain">                          </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-02-10 13:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-02-20 12:00:01&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-03-01 12:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-03-01 12:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ambient_temp&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;2020-03-01 12:00:00&#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    metric</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">round</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">avg</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">OVER</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> metric </span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"> toDate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">ts</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">       Range </span><span class="token operator" style="color:rgb(212, 212, 212)">BETWEEN</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">PRECEDING</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">AND</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">CURRENT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">ROW</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">AS</span><span class="token plain"> moving_avg_10_days_temp</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">FROM</span><span class="token plain"> sensors</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    metric </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    ts </span><span class="token keyword" style="color:rgb(86, 156, 214)">ASC</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┌─metric───────┬──────────────────ts─┬─</span><span class="token keyword" style="color:rgb(86, 156, 214)">value</span><span class="token plain">─┬─moving_avg_10_days_temp─┐</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │                      </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │                      </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">11</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token plain"> │                    </span><span class="token number" style="color:rgb(181, 206, 168)">12.5</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │     </span><span class="token number" style="color:rgb(181, 206, 168)">9</span><span class="token plain"> │                    </span><span class="token number" style="color:rgb(181, 206, 168)">12.5</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> │                      </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> │                      </span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain"> │                      </span><span class="token number" style="color:rgb(181, 206, 168)">11</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">10</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">13</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain"> │                      </span><span class="token number" style="color:rgb(181, 206, 168)">11</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">02</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">20</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │                   </span><span class="token number" style="color:rgb(181, 206, 168)">13.33</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">03</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │                      </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">03</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │                      </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ ambient_temp │ </span><span class="token number" style="color:rgb(181, 206, 168)">2020</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">03</span><span class="token operator" style="color:rgb(212, 212, 212)">-</span><span class="token number" style="color:rgb(181, 206, 168)">01</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">12</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain">:</span><span class="token number" style="color:rgb(181, 206, 168)">00</span><span class="token plain"> │    </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │                      </span><span class="token number" style="color:rgb(181, 206, 168)">16</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└──────────────┴─────────────────────┴───────┴─────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="related-content">Related Content<a href="#related-content" class="hash-link" aria-label="Direct link to Related Content" title="Direct link to Related Content">​</a></h2><ul><li>Blog: <a href="https://clickhouse.com/blog/working-with-time-series-data-and-functions-ClickHouse" target="_blank" rel="noopener noreferrer">Working with time series data in ClickHouse</a></li><li>Blog: <a href="https://clickhouse.com/blog/clickhouse-window-array-functions-git-commits" target="_blank" rel="noopener noreferrer">Window and array functions for Git commit sequences</a></li><li>Blog: <a href="https://clickhouse.com/blog/getting-data-into-clickhouse-part-3-s3" target="_blank" rel="noopener noreferrer">Getting Data Into ClickHouse - Part 3 - Using S3</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ClickHouse/ClickHouse/tree/master/docs/ru/sql-reference/window-functions/index.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev paginationNavLink_UdUv" href="/docs/ru/sql-reference/ansi"><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.2751 19.175L10.3251 18.125L5.4501 13.25H21.6001V11.75H5.4501L10.3251 6.87501L9.2751 5.82501L2.5751 12.5L9.2751 19.175Z" fill="currentColor"></path></svg><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">Previous</div><div class="paginationNavLabel_YPzM pagination-nav__label">ANSI Compatibility</div></div></a><a class="pagination-nav__link pagination-nav__link--next paginationNavLink_UdUv" href="/docs/ru/guides"><div class="paginationNavContent__3xr"><div class="pagination-nav__sublabel">Next</div><div class="paginationNavLabel_YPzM pagination-nav__label">Руководства</div></div><svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14.7249 19.175L13.6749 18.125L18.5499 13.25H2.3999V11.75H18.5499L13.6749 6.87501L14.7249 5.82501L21.4249 12.5L14.7249 19.175Z" fill="currentColor"></path></svg></a></nav></div></div></div></div></main></div></div><footer class="footer footer_jryj"><div class="container_y1z5 container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2016&ndash;2023 ClickHouse, Inc.</div></div><div><div class="footer__links text--center"><div class="footer__links"><a href="https://clickhouse.com/legal/trademark-policy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trademark</a><span class="footer__link-separator">·</span><a href="https://clickhouse.com/legal/privacy-policy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a><span class="footer__link-separator">·</span><a href="https://trust.clickhouse.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Security</a><span class="footer__link-separator">·</span><a href="https://clickhouse.com/legal/agreements/terms-of-service" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Service</a></div></div></div></div><button class="colorModeButton_hk25"><svg xmlns="http://www.w3.org/2000/svg" fill="none" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"></path></svg><span>dark Mode</span></button></footer></div>
<script src="/docs/assets/js/runtime~main.4296040c.js"></script>
<script src="/docs/assets/js/main.299dbf94.js"></script>
</body>
</html>
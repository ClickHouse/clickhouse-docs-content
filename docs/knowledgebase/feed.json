{
    "version": "https://jsonfeed.org/version/1",
    "title": "ClickHouse Knowledge Base Feed",
    "home_page_url": "https://clickhouse.com/docs/knowledgebase",
    "description": "Feed of articles posted to the ClickHouse Knowledge Base",
    "items": [
        {
            "id": "https://clickhouse.com/docs/knowledgebase/how_to_display_queries_using_MV",
            "content_html": "<p><strong>Question:</strong> How do I show all queries involving materialized views in the last 60m?</p><p><strong>Answer:</strong></p><p>This query will display all queries directed towards Materialized Views considering that:</p><ul><li>we can leverage the <code>create_table_query</code> field in <code>system.tables</code> table to identify what tables are explicit (<code>TO</code>) recipient of MVs;</li><li>we can track back (using <code>uuid</code> and the name convention <code>.inner_id.&lt;uuid&gt;</code>) what tables are implicit recipient of MVs;</li></ul><p>We can also configure how long back in time we want to look, by changing the value (<code>60</code> m by default) in the initial query CTE</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WITH</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">60</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(106, 153, 85)\">-- default 60m</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">AS</span><span class=\"token plain\"> timeRange</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(106, 153, 85)\">--prepare names of possible implicit MV hidden target tables for *any* table with NON NULL uuid</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> groupArray</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            concat</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'default.`.inner_id.'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> toString</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">uuid</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'`'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> clusterAllReplicas</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">default</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> system</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">tables</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WHERE</span><span class=\"token plain\"> notEmpty</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">uuid</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">AS</span><span class=\"token plain\"> MV_implicit_possible_hidden_target_tables_names_array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(106, 153, 85)\">--captures MV name and target tables (if TO is specified)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token comment\" style=\"color:rgb(106, 153, 85)\">--TODO it seems that extract will return just the first capturing group :( replace with regexpExtract once available</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> arrayFilter</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            x</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">!=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">''</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            </span><span class=\"token comment\" style=\"color:rgb(106, 153, 85)\">--remove empty captures</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            groupArray</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                extract</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                    create_table_query</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'^CREATE MATERIALIZED VIEW\\s(\\w+\\.\\w+)\\s(?:TO\\s(\\S+))?'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> clusterAllReplicas</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">default</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> system</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">tables</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WHERE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">engine</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'MaterializedView'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">AS</span><span class=\"token plain\"> MV_explicit_target_tables_names_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> event_time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    query</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">tables</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">as</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"MVs tables\"</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> clusterAllReplicas</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">default</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> system</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">query_log</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WHERE</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token comment\" style=\"color:rgb(106, 153, 85)\">-- only SELECT within 60m</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        event_time </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">now</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\"> toIntervalMinute</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">timeRange</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">AND</span><span class=\"token plain\"> startsWith</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">query</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'SELECT'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(106, 153, 85)\">-- check either that query involves implicit MV target table names</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">AND</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        hasAny</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">tables</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            MV_implicit_possible_hidden_target_tables_names_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">OR</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(106, 153, 85)\">-- check that query involves explicit MV target table</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        hasAny</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">tables</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> MV_explicit_target_tables_names_array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ORDER</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">BY</span><span class=\"token plain\"> event_time </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DESC</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>expected output:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> event_time          </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> query                                                                                          </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> MVs </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">tables</span><span class=\"token plain\">                                                            </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token comment\" style=\"color:rgb(106, 153, 85)\">------------------- | ---------------------------------------------------------------------------------------------- | --------------------------------------------------------------------- |</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">2023</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">02</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">23</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">08</span><span class=\"token plain\">:</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">14</span><span class=\"token plain\">:</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">14</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\">     rand</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\">     </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">default</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">sum_of_volumes</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">     </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">default</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">big_changes</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">     system</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">users </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"default.big_changes_mv\"</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"default.sum_of_volumes_mv\"</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"system.users\"</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">2023</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">02</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">23</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">08</span><span class=\"token plain\">:</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">04</span><span class=\"token plain\">:</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">47</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\">     price</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\">     </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">default</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">sum_of_volumes</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">     </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">default</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">big_changes                    </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"default.big_changes_mv\"</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"default.sum_of_volumes_mv\"</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>In this example results above <code>default.big_changes_mv</code> and <code>default.sum_of_volumes_mv</code> are both materialized views.</p>",
            "url": "https://clickhouse.com/docs/knowledgebase/how_to_display_queries_using_MV",
            "title": "What queries are using Materialized Views?",
            "summary": "Question: How do I show all queries involving materialized views in the last 60m?",
            "date_modified": "2023-03-24T00:00:00.000Z",
            "tags": []
        },
        {
            "id": "https://clickhouse.com/docs/knowledgebase/importing_and_working_with_JSON_array_objects",
            "content_html": "<p><strong>Question:</strong> How do I import JSON arrays and how can I query the inner objects?</p><p><strong>Answer:</strong></p><p>Dump this 1 line JSON array to <code>sample.json</code></p><div class=\"codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"_id\":\"1\",\"channel\":\"help\",\"events\":[{\"eventType\":\"open\",\"time\":\"2021-06-18T09:42:39.527Z\"},{\"eventType\":\"close\",\"time\":\"2021-06-18T09:48:05.646Z\"}]},{\"_id\":\"2\",\"channel\":\"help\",\"events\":[{\"eventType\":\"open\",\"time\":\"2021-06-18T09:42:39.535Z\"},{\"eventType\":\"edit\",\"time\":\"2021-06-18T09:42:41.317Z\"}]},{\"_id\":\"3\",\"channel\":\"questions\",\"events\":[{\"eventType\":\"close\",\"time\":\"2021-06-18T09:42:39.543Z\"},{\"eventType\":\"create\",\"time\":\"2021-06-18T09:52:51.299Z\"}]},{\"_id\":\"4\",\"channel\":\"general\",\"events\":[{\"eventType\":\"create\",\"time\":\"2021-06-18T09:42:39.552Z\"},{\"eventType\":\"edit\",\"time\":\"2021-06-18T09:47:29.109Z\"}]},{\"_id\":\"5\",\"channel\":\"general\",\"events\":[{\"eventType\":\"edit\",\"time\":\"2021-06-18T09:42:39.560Z\"},{\"eventType\":\"open\",\"time\":\"2021-06-18T09:42:39.680Z\"},{\"eventType\":\"close\",\"time\":\"2021-06-18T09:42:41.207Z\"},{\"eventType\":\"edit\",\"time\":\"2021-06-18T09:42:43.372Z\"},{\"eventType\":\"edit\",\"time\":\"2021-06-18T09:42:45.642Z\"}]}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Check the data:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> :</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">file</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'/path/to/sample.json'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'JSONEachRow'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">file</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'/path/to/sample.json'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'JSONEachRow'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0</span><span class=\"token plain\">bbfa09f</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">ac7f</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4</span><span class=\"token plain\">a1e</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">9227</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">2961</span><span class=\"token plain\">b5ffc2d4</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─_id─┬─channel───┬─events─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│   </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token plain\"> │ help      │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'open'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.527Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:48:05.646Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                                                                                           │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│   </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">2</span><span class=\"token plain\"> │ help      │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'open'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.535Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:41.317Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                                                                                            │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│   </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">3</span><span class=\"token plain\"> │ questions │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.543Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'create'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:52:51.299Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                                                                                         │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│   </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4</span><span class=\"token plain\"> │ general   │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'create'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.552Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:47:29.109Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                                                                                          │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│   </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\"> │ general   │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.560Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'open'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.680Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:41.207Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:43.372Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\">{</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'eventType'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'time'</span><span class=\"token plain\">:</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:45.642Z'</span><span class=\"token plain\">}</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\"> │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────┴───────────┴────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0.001</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> </span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Create a table to receive the JSON rows:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> :</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">CREATE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">TABLE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">IF</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">NOT</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">EXISTS</span><span class=\"token plain\"> sample_json_array </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">rawJSON</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> String EPHEMERAL</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">_id</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> String </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DEFAULT</span><span class=\"token plain\"> JSONExtractString</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">rawJSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'_id'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">channel</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> String </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DEFAULT</span><span class=\"token plain\"> JSONExtractString</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">rawJSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'channel'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">actions</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">JSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DEFAULT</span><span class=\"token plain\"> JSONExtract</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">rawJSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'actions'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ENGINE</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> MergeTree</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ORDER</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">BY</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            channel</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">CREATE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">TABLE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">IF</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">NOT</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">EXISTS</span><span class=\"token plain\"> sample_json_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">rawJSON</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> String EPHEMERAL</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">_id</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> String </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DEFAULT</span><span class=\"token plain\"> JSONExtractString</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">rawJSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'_id'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">channel</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> String </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DEFAULT</span><span class=\"token plain\"> JSONExtractString</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">rawJSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'channel'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">actions</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">JSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DEFAULT</span><span class=\"token plain\"> JSONExtract</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">rawJSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'actions'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ENGINE</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> MergeTree</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ORDER</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">BY</span><span class=\"token plain\"> channel</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: e90c26e7</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">a950</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4520</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">a517</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">6</span><span class=\"token plain\">d437856f81d</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0.173</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> </span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Insert the data:</p><div class=\"codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook.local :) INSERT INTO</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            sample_json_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        SELECT</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            *</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            file(</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                                '/opt/cases/000000/sample_json_arrays.json',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                                'JSONEachRow'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            );</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">INSERT INTO sample_json_array SELECT *</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">FROM file('/opt/cases/000000/sample.json', 'JSONEachRow')</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: 60c4beab-3c2c-40c1-9c6f-bbbd7118dde3</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Ok.</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">0 rows in set. Elapsed: 0.002 sec.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Check how the data inference acted on JSON object type:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> :</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DESCRIBE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">TABLE</span><span class=\"token plain\"> sample_json_object_array SETTINGS describe_extend_object_types </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DESCRIBE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">TABLE</span><span class=\"token plain\"> sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">SETTINGS describe_extend_object_types </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: a28c2850</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">885</span><span class=\"token plain\">d</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4</span><span class=\"token plain\">c3a</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">b1bc</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">e5931909e89a</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─name────┬─</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">type</span><span class=\"token plain\">────────────────────────────────────────┬─default_type─┬─default_expression─────────────────────┬─</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">comment</span><span class=\"token plain\">─┬─codec_expression─┬─ttl_expression─┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ rawJSON │ String                                      │ EPHEMERAL    │ defaultValueOfTypeName</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'String'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">       │         │                  │                │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ _id     │ String                                      │ </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DEFAULT</span><span class=\"token plain\">      │ JSONExtractString</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">rawJSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'_id'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">      │         │                  │                │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ channel │ String                                      │ </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DEFAULT</span><span class=\"token plain\">      │ JSONExtractString</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">rawJSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'channel'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">  │         │                  │                │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ events  │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">Tuple</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">eventType String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token plain\"> String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> │ </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DEFAULT</span><span class=\"token plain\">      │ JSONExtractArrayRaw</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">rawJSON</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'events'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> │         │                  │                │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────────┴─────────────────────────────────────────────┴──────────────┴────────────────────────────────────────┴─────────┴──────────────────┴────────────────┘</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p><code>Events</code> is an <em>Array</em> of <code>Tuple</code> each containing a <em>eventType</em> <code>String</code> and a <em>time</em> <code>String</code> fields. This latter type is suboptimal (we'd want <code>DateTime</code> instead).</p><p>Let's see the data:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> :</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            channel</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WHERE</span><span class=\"token plain\"> has</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    channel</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WHERE</span><span class=\"token plain\"> has</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">3</span><span class=\"token plain\">ddd6843</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5206</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4</span><span class=\"token plain\">f52</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">971</span><span class=\"token plain\">f</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1699</span><span class=\"token plain\">f0ba1728</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─_id─┬─channel───┬─events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType──────────────────────┬─events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token plain\">──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\">   │ general   │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'open'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\"> │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.560Z'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.680Z'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:41.207Z'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:43.372Z'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:45.642Z'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\"> │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token plain\">   │ help      │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'open'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                      │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.527Z'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:48:05.646Z'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                                  │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">3</span><span class=\"token plain\">   │ questions │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'create'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                    │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:42:39.543Z'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18T09:52:51.299Z'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                                  │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────┴───────────┴───────────────────────────────────────┴──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">3</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0.001</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> </span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Let's run a few queries:</p><p><code>_id</code> and <code>channel</code> of events that have an <code>eventType</code> of value <code>close</code></p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> :</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            channel</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WHERE</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            has</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    channel</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WHERE</span><span class=\"token plain\"> has</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">033</span><span class=\"token plain\">a0c56</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">7</span><span class=\"token plain\">bfa</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4261</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">a334</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">7323</span><span class=\"token plain\">bdc40f87</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─_id─┬─channel───┬─events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType──────────────────────┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\">   │ general   │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'open'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\"> │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token plain\">   │ help      │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'open'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                      │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">3</span><span class=\"token plain\">   │ questions │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'create'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                    │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────┴───────────┴───────────────────────────────────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─_id─┬─channel───┬─events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">eventType──────────────────────┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\">   │ general   │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'open'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'edit'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\"> │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token plain\">   │ help      │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'open'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                      │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">3</span><span class=\"token plain\">   │ questions │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'close'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'create'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                    │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────┴───────────┴───────────────────────────────────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">6</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0.001</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> </span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>We want to query the <code>time</code> , for example all events between a given time range, but we notice it was imported as <code>String</code>:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> :</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> toTypeName</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> sample_json_object_array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> toTypeName</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">27</span><span class=\"token plain\">f07f02</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">66</span><span class=\"token plain\">cd</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">420</span><span class=\"token plain\">d</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">8623</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">eeed7d501014</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─toTypeName</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">─┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">           │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">           │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">           │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">           │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">           │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────────────────────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0.001</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> </span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>So, in order to handle these as dates, first we want to convert to <code>DateTime</code>.\nTo convert an array we use a map function:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> :</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            channel</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\">parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    channel</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: f3c7881e</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">b41c</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4872</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">9</span><span class=\"token plain\">c67</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\">c25966599a1</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─_id─┬─channel───┬─arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">lambda</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">tuple</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">─────────────────────────────────────────────┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4</span><span class=\"token plain\">   │ general   │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:39'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:47:29'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                   │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\">   │ general   │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:39'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:39'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:41'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:43'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:45'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\"> │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token plain\">   │ help      │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:39'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:48:05'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                   │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">2</span><span class=\"token plain\">   │ help      │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:39'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:41'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                   │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">3</span><span class=\"token plain\">   │ questions │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:39'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:52:51'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                                                                   │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────┴───────────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0.001</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>we can appreciate the diffs using <code>toTypeName</code> on both the arrays:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> :</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            channel</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            toTypeName</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">as</span><span class=\"token plain\"> events_as_strings</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            toTypeName</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\">parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">as</span><span class=\"token plain\"> events_as_datetime</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    channel</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    toTypeName</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">AS</span><span class=\"token plain\"> events_as_strings</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    toTypeName</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">AS</span><span class=\"token plain\"> events_as_datetime</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token plain\">af54994</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">b756</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">472</span><span class=\"token plain\">f</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">88</span><span class=\"token plain\">d7</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">8</span><span class=\"token plain\">b5cdca0e54e</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─_id─┬─channel───┬─events_as_strings─┬─events_as_datetime─┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4</span><span class=\"token plain\">   │ general   │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">     │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">    │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\">   │ general   │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">     │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">    │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token plain\">   │ help      │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">     │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">    │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">2</span><span class=\"token plain\">   │ help      │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">     │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">    │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">3</span><span class=\"token plain\">   │ questions │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">     │ Array</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">    │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────┴───────────┴───────────────────┴────────────────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0.001</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> </span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>now let's get the <code>id</code> of  of the rows where <code>time</code> is between a given interval.</p><p>we use <code>arrayCount</code> to see if there is a count greater than than 0 of items in the array returned by the map function that will match the condition <code>x BETWEEN toDateTime('2021-06-18 11:46:00', 'Europe/Rome') AND toDateTime('2021-06-18 11:50:00', 'Europe/Rome')</code></p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhousebook</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> :</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                        </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WHERE</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            arrayCount</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                                x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">BETWEEN</span><span class=\"token plain\"> toDateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:46:00'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'Europe/Rome'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                                </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">AND</span><span class=\"token plain\"> toDateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:50:00'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'Europe/Rome'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                                arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                            </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    _id</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> sample_json_object_array</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">WHERE</span><span class=\"token plain\"> arrayCount</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;=</span><span class=\"token plain\"> toDateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:46:00'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'Europe/Rome'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">AND</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&lt;=</span><span class=\"token plain\"> toDateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:50:00'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'Europe/Rome'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: d4882fc3</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">9</span><span class=\"token plain\">f99</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4</span><span class=\"token plain\">e87</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">9</span><span class=\"token plain\">f89</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">47683</span><span class=\"token plain\">f10656d</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─_id─┬─arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">lambda</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">tuple</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> parseDateTimeBestEffort</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> events</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\">─┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4</span><span class=\"token plain\">   │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:39'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:47:29'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                       │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token plain\">   │ </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">[</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:42:39'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2021-06-18 11:48:05'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">]</span><span class=\"token plain\">                       │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────┴─────────────────────────────────────────────────────────────────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">2</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0.002</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> </span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>⚠️</p><p>Please remember, at the time of writing this article the current implementation of JSON is experimental and not suited for production.</p><p>This example highlights how to quickly import JSON and start querying it and represents a tradeoff between the ease of use where we import the JSON objects as <code>JSON</code> type with no need to specify upfront the schema type. Convenient for a quick test however for long term use of the data we would like to, with regards to this example to store the data using the most appropriate types, so for the <code>time</code> field, use <code>DateTime</code> instead of <code>String</code>, in order to avoid any post-ingestion phase conversion as illustrated above. Please refer to the <a href=\"https://clickhouse.com/docs/en/integrations/data-formats/json\" target=\"_blank\" rel=\"noopener noreferrer\">documentation</a> for more about handling JSON.</p>",
            "url": "https://clickhouse.com/docs/knowledgebase/importing_and_working_with_JSON_array_objects",
            "title": "Importing and querying JSON array objects",
            "summary": "Question: How do I import JSON arrays and how can I query the inner objects?",
            "date_modified": "2023-03-24T00:00:00.000Z",
            "tags": []
        },
        {
            "id": "https://clickhouse.com/docs/knowledgebase/recreate_table_across_terminals",
            "content_html": "<p><strong>Question:</strong></p><p>How can I quickly recreate a table and its data using just copy/paste across different terminals?</p><p><strong>Answer:</strong></p><p>This is NOT a recommended practice to migrate data from one database to another and it should NOT be used for production data migration.</p><p>This is simply intended as a quick and dirty way to recreate small amount of data when developing across multiple environments.</p><ol><li>Get the CREATE TABLE statement with <code>SHOW CREATE table</code>:</li></ol><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SHOW</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">CREATE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">TABLE</span><span class=\"token plain\"> cookies</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SHOW</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">CREATE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">TABLE</span><span class=\"token plain\"> cookies</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">248</span><span class=\"token plain\">ec8e2</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">5</span><span class=\"token plain\">bce</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">45</span><span class=\"token plain\">b3</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">97</span><span class=\"token plain\">d9</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">ed68edf445a5</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─statement────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">CREATE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">TABLE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">default</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">cookies</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">id</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">timestamp</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DateTime</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ENGINE</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> MergeTree</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ORDER</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">BY</span><span class=\"token plain\"> id</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">SETTINGS index_granularity </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">8192</span><span class=\"token plain\"> │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><ol start=\"2\"><li>Get the data export using <code>FORMAT SQLInsert</code></li></ol><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> cookies FORMAT SQLInsert</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> cookies</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">FORMAT SQLInsert</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">383759</span><span class=\"token plain\">b8</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">69</span><span class=\"token plain\">c0</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">4561</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">ab95</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">f8224abc0071</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INSERT</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INTO</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">table</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">id</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">timestamp</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">VALUES</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'4'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:28:46'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:28:41'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'1'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:11:02'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'1'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:11:40'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'1'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:11:48'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'1'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:16:05'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:11:06'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'3'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:11:12'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'3'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:11:45'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'3'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:16:08'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'4'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:11:14'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'4'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:11:50'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'4'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:16:01'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'5'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:11:18'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'5'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'2023-03-15 16:16:11'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">15</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0.023</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Note you will need to replace the name <code>table</code> at point 2 with the actual table name (<code>cookies</code> in this example)</p>",
            "url": "https://clickhouse.com/docs/knowledgebase/recreate_table_across_terminals",
            "title": "How to quickly recreate a small table across different terminals",
            "summary": "Question:",
            "date_modified": "2023-03-24T00:00:00.000Z",
            "tags": []
        },
        {
            "id": "https://clickhouse.com/docs/knowledgebase/s3_export_data_year_month_folders",
            "content_html": "<p>I want to export data segregating the path in S3 bucket to follow a structure like:</p><ul><li>2022<ul><li>1</li><li>2</li><li>...</li><li>12</li></ul></li><li>2021<ul><li>1</li><li>2</li><li>...</li><li>12</li></ul></li></ul><p>and so on ...</p><h3 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"answer\">Answer<a href=\"#answer\" class=\"hash-link\" aria-label=\"Direct link to Answer\" title=\"Direct link to Answer\">​</a></h3><p>Considering the ClickHouse table:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">CREATE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">TABLE</span><span class=\"token plain\"> sample_data </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">name</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">age</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">Int</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier\">time</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DateTime</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ENGINE</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> MergeTree</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ORDER</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">BY</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    name</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Add 10000 entries:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INSERT</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INTO</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    sample_data</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    generateRandom</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'name String, age Int, time DateTime'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">10</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">10</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">10</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">LIMIT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">10000</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Run this to create the desired structure in s3 bucket <code>my_bucket</code> (note this example writes files in parquet format):</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">NSERT </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INTO</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FUNCTION</span><span class=\"token plain\"> s3</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'https://s3-host:4321/my_bucket/{_partition_id}/file.parquet'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'s3-access-key'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'s3-secret-access-key'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        Parquet</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'name String, age Int, time DateTime'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'gzip'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">PARTITION</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">BY</span><span class=\"token plain\"> concat</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        formatDateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'%Y'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'/'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        formatDateTime</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'%m'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    name</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    age</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">time</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    sample_data</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">55</span><span class=\"token plain\">adcf22</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">f6af</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">491</span><span class=\"token plain\">e</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">b697</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">d09694bbcc56</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Ok</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">0</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">in</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">set</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Elapsed: </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">15.579</span><span class=\"token plain\"> sec</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\"> Processed </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">10.00</span><span class=\"token plain\"> thousand </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">219.93</span><span class=\"token plain\"> KB </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">641.87</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">rows</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">/</span><span class=\"token plain\">s</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">14.12</span><span class=\"token plain\"> KB</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">/</span><span class=\"token plain\">s</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div>",
            "url": "https://clickhouse.com/docs/knowledgebase/s3_export_data_year_month_folders",
            "title": "How can I do partitioned writes by year and month on S3?",
            "summary": "I want to export data segregating the path in S3 bucket to follow a structure like:",
            "date_modified": "2023-03-24T00:00:00.000Z",
            "tags": []
        },
        {
            "id": "https://clickhouse.com/docs/knowledgebase/which-processes-are-currently-running",
            "content_html": "<p>ClickHouse has a built-in debugger and introspection capabilities. For example, you can get the stack traces of every server's thread at runtime by querying the <code>system.stack_trace</code> table:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">count</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    arrayStringConcat</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">arrayMap</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> concat</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">demangle</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">addressToSymbol</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'\\n    '</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> addressToLine</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">x</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> trace</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'\\n'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">AS</span><span class=\"token plain\"> sym</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> system</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token plain\">stack_trace</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">GROUP</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">BY</span><span class=\"token plain\"> trace</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ORDER</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">BY</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">count</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DESC</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">LIMIT</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">10</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">FORMAT Vertical</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">SETTINGS allow_introspection_functions </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>The query result will show the locations in the ClickHouse source code where the threads are running or waiting. (You will need to set <code>allow_introspection_functions</code> to <code>1</code> to enable the <a href=\"https://clickhouse.com/docs/en/sql-reference/functions/introspection\" target=\"_blank\" rel=\"noopener noreferrer\">introspection functions</a>.) The response looks like:</p><div class=\"language-response codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-response codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 1:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">──────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 144</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:     pthread_cond_wait</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">DB::BackgroundSchedulePool::threadFunction()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;std::__1::thread&gt;::worker(std::__1::__list_iterator&lt;std::__1::thread, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 2:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">──────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 80</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:     pthread_cond_wait</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">std::__1::condition_variable::wait(std::__1::unique_lock&lt;std::__1::mutex&gt;&amp;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">DB::MergeTreeBackgroundExecutor&lt;DB::OrdinaryRuntimeQueue&gt;::threadFunction()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;ThreadFromGlobalPoolImpl&lt;false&gt;&gt;::worker(std::__1::__list_iterator&lt;ThreadFromGlobalPoolImpl&lt;false&gt;, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">void std::__1::__function::__policy_invoker&lt;void ()&gt;::__call_impl&lt;std::__1::__function::__default_alloc_func&lt;ThreadFromGlobalPoolImpl&lt;false&gt;::ThreadFromGlobalPoolImpl&lt;void ThreadPoolImpl&lt;ThreadFromGlobalPoolImpl&lt;false&gt;&gt;::scheduleImpl&lt;void&gt;(std::__1::function&lt;void ()&gt;, long, std::__1::optional&lt;unsigned long&gt;, bool)::'lambda0'()&gt;(void&amp;&amp;)::'lambda'(), void ()&gt;&gt;(std::__1::__function::__policy_storage const*)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;std::__1::thread&gt;::worker(std::__1::__list_iterator&lt;std::__1::thread, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 3:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">──────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 55</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:     pthread_cond_wait</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;ThreadFromGlobalPoolImpl&lt;false&gt;&gt;::worker(std::__1::__list_iterator&lt;ThreadFromGlobalPoolImpl&lt;false&gt;, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">void std::__1::__function::__policy_invoker&lt;void ()&gt;::__call_impl&lt;std::__1::__function::__default_alloc_func&lt;ThreadFromGlobalPoolImpl&lt;false&gt;::ThreadFromGlobalPoolImpl&lt;void ThreadPoolImpl&lt;ThreadFromGlobalPoolImpl&lt;false&gt;&gt;::scheduleImpl&lt;void&gt;(std::__1::function&lt;void ()&gt;, long, std::__1::optional&lt;unsigned long&gt;, bool)::'lambda0'()&gt;(void&amp;&amp;)::'lambda'(), void ()&gt;&gt;(std::__1::__function::__policy_storage const*)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;std::__1::thread&gt;::worker(std::__1::__list_iterator&lt;std::__1::thread, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 4:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">──────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 16</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">DB::AsynchronousInsertQueue::processBatchDeadlines(unsigned long)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;std::__1::thread&gt;::worker(std::__1::__list_iterator&lt;std::__1::thread, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 5:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">──────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 16</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:     pthread_cond_wait</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">std::__1::condition_variable::wait(std::__1::unique_lock&lt;std::__1::mutex&gt;&amp;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">DB::MergeTreeBackgroundExecutor&lt;DB::MergeMutateRuntimeQueue&gt;::threadFunction()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;ThreadFromGlobalPoolImpl&lt;false&gt;&gt;::worker(std::__1::__list_iterator&lt;ThreadFromGlobalPoolImpl&lt;false&gt;, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">void std::__1::__function::__policy_invoker&lt;void ()&gt;::__call_impl&lt;std::__1::__function::__default_alloc_func&lt;ThreadFromGlobalPoolImpl&lt;false&gt;::ThreadFromGlobalPoolImpl&lt;void ThreadPoolImpl&lt;ThreadFromGlobalPoolImpl&lt;false&gt;&gt;::scheduleImpl&lt;void&gt;(std::__1::function&lt;void ()&gt;, long, std::__1::optional&lt;unsigned long&gt;, bool)::'lambda0'()&gt;(void&amp;&amp;)::'lambda'(), void ()&gt;&gt;(std::__1::__function::__policy_storage const*)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;std::__1::thread&gt;::worker(std::__1::__list_iterator&lt;std::__1::thread, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 6:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">──────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 10</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:     poll</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::Net::SocketImpl::pollImpl(Poco::Timespan&amp;, int)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::Net::SocketImpl::poll(Poco::Timespan const&amp;, int)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::Net::TCPServer::run()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::ThreadImpl::runnableEntry(void*)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 7:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">──────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 9</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:     pthread_cond_wait</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;std::__1::thread&gt;::worker(std::__1::__list_iterator&lt;std::__1::thread, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 8:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">──────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 7</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:     poll</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::Net::SocketImpl::pollImpl(Poco::Timespan&amp;, int)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::Net::SocketImpl::poll(Poco::Timespan const&amp;, int)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">DB::ReadBufferFromPocoSocket::poll(unsigned long) const</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">DB::TCPHandler::runImpl()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">DB::TCPHandler::run()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::Net::TCPServerConnection::start()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::Net::TCPServerDispatcher::run()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::PooledThread::run()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::ThreadImpl::runnableEntry(void*)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 9:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">───────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 3</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:     pthread_cond_wait</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::EventImpl::waitImpl()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">DB::DDLWorker::runCleanupThread()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">void std::__1::__function::__policy_invoker&lt;void ()&gt;::__call_impl&lt;std::__1::__function::__default_alloc_func&lt;ThreadFromGlobalPoolImpl&lt;true&gt;::ThreadFromGlobalPoolImpl&lt;void (DB::DDLWorker::*)(), DB::DDLWorker*&gt;(void (DB::DDLWorker::*&amp;&amp;)(), DB::DDLWorker*&amp;&amp;)::'lambda'(), void ()&gt;&gt;(std::__1::__function::__policy_storage const*)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;std::__1::thread&gt;::worker(std::__1::__list_iterator&lt;std::__1::thread, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Row 10:</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">───────</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">count(): 3</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">sym:     pthread_cond_wait</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Poco::EventImpl::waitImpl()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">DB::DDLWorker::runMainThread()</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">void std::__1::__function::__policy_invoker&lt;void ()&gt;::__call_impl&lt;std::__1::__function::__default_alloc_func&lt;ThreadFromGlobalPoolImpl&lt;true&gt;::ThreadFromGlobalPoolImpl&lt;void (DB::DDLWorker::*)(), DB::DDLWorker*&gt;(void (DB::DDLWorker::*&amp;&amp;)(), DB::DDLWorker*&amp;&amp;)::'lambda'(), void ()&gt;&gt;(std::__1::__function::__policy_storage const*)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ThreadPoolImpl&lt;std::__1::thread&gt;::worker(std::__1::__list_iterator&lt;std::__1::thread, void*&gt;)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    /usr/bin/clickhouse</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clone</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">10 rows in set. Elapsed: 0.026 sec.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw\"><div class=\"alert-icon admonitionIcon_Ibzs\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></div><div class=\"alert-content admonitionContent_vXIg\"><div class=\"admonitionHeading_TMsN\">note</div><p>If you installed ClickHouse from a <strong>.deb/.rpm/.tgz</strong> you can also install the package with the debug info to see the line numbers from the source code:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">sudo</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">apt</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">install</span><span class=\"token plain\"> clickhouse-common-static-dbg</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>If you've installed ClickHouse as a single-binary, it already contains the debug info.</p></div></div><div class=\"theme-admonition theme-admonition-tip alert alert--success admonition_WoCw\"><div class=\"alert-icon admonitionIcon_Ibzs\"><svg viewBox=\"0 0 12 16\"><path fill-rule=\"evenodd\" d=\"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z\"></path></svg></div><div class=\"alert-content admonitionContent_vXIg\"><div class=\"admonitionHeading_TMsN\">tip</div><p>For more high-level information, check out some of these other system tables:</p><ul><li><a href=\"https://clickhouse.com/docs/en/operations/system-tables/processes\" target=\"_blank\" rel=\"noopener noreferrer\">system.processes</a></li><li><a href=\"https://clickhouse.com/docs/en/operations/system-tables/query_log\" target=\"_blank\" rel=\"noopener noreferrer\">system.query_log</a></li><li><a href=\"https://clickhouse.com/docs/en/operations/system-tables/metric_log\" target=\"_blank\" rel=\"noopener noreferrer\">system.metric_log</a></li><li><a href=\"https://clickhouse.com/docs/en/operations/system-tables/asynchronous_metric_log\" target=\"_blank\" rel=\"noopener noreferrer\">system.asynchronous_metric_log</a></li><li><a href=\"https://clickhouse.com/docs/en/operations/system-tables/trace_log\" target=\"_blank\" rel=\"noopener noreferrer\">system.trace_log</a></li><li><a href=\"https://clickhouse.com/docs/en/operations/system-tables/processors_profile_log\" target=\"_blank\" rel=\"noopener noreferrer\">system.processor_profile_log</a></li></ul><p>And there is handy info in the <a href=\"https://clickhouse.com/docs/en/operations/system-tables\" target=\"_blank\" rel=\"noopener noreferrer\">other system tables</a> also.</p></div></div>",
            "url": "https://clickhouse.com/docs/knowledgebase/which-processes-are-currently-running",
            "title": "How to check what code is currently running on a server?",
            "summary": "ClickHouse has a built-in debugger and introspection capabilities. For example, you can get the stack traces of every server's thread at runtime by querying the system.stack_trace table:",
            "date_modified": "2023-03-24T00:00:00.000Z",
            "tags": []
        },
        {
            "id": "https://clickhouse.com/docs/knowledgebase/file-export",
            "content_html": "<h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"using-into-outfile-clause\">Using INTO OUTFILE Clause<a href=\"#using-into-outfile-clause\" class=\"hash-link\" aria-label=\"Direct link to Using INTO OUTFILE Clause\" title=\"Direct link to Using INTO OUTFILE Clause\">​</a></h2><p>Add an <a href=\"https://clickhouse.com/docs/en/sql-reference/statements/select/into-outfile.md\" target=\"_blank\" rel=\"noopener noreferrer\">INTO OUTFILE</a> clause to your query.</p><p>For example:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">table</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INTO</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">OUTFILE</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'file'</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>By default, ClickHouse uses the file extension of the filename to deteremine the output format and compression. For example, all of the rows in <code>nyc_taxi</code> will be exported to the <code>nyc_taxi.parquet</code> using the Parquet format:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> nyc_taxi</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INTO</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">OUTFILE</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'taxi_rides.parquet'</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>And the following file will be a compressed, tab-separated file:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> nyc_taxi</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INTO</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">OUTFILE</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'taxi_rides.tsv.gz'</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>If ClickHouse can not determine the format from the file extension, then the output format defaults to <a href=\"https://clickhouse.com/docs/en/interfaces/formats.md\" target=\"_blank\" rel=\"noopener noreferrer\">TabSeparated</a> for output data. To specify the <a href=\"https://clickhouse.com/docs/en/interfaces/formats.md\" target=\"_blank\" rel=\"noopener noreferrer\">output format</a>, use the <a href=\"https://clickhouse.com/docs/en/sql-reference/statements/select/format.md\" target=\"_blank\" rel=\"noopener noreferrer\">FORMAT clause</a>.</p><p>For example:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">SELECT</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">*</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">FROM</span><span class=\"token plain\"> nyc_taxi</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INTO</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">OUTFILE</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'taxi_rides.txt'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">FORMAT CSV</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"using-a-file-engine-table\">Using the File table engine<a href=\"#using-a-file-engine-table\" class=\"hash-link\" aria-label=\"Direct link to Using the File table engine\" title=\"Direct link to Using the File table engine\">​</a></h2><p>Another option is to use the <a href=\"https://clickhouse.com/docs/en/engines/table-engines/special/file\" target=\"_blank\" rel=\"noopener noreferrer\">File</a> table engine, where ClickHouse uses the file to store the data. You can perform queries and inserts directly on the file.</p><p>For example:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">CREATE</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">TABLE</span><span class=\"token plain\"> my_table </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">   x UInt32</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">   y String</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">   z </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">DateTime</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">ENGINE</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">=</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">File</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\">Parquet</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Insert a few rows:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INSERT</span><span class=\"token plain\"> </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">INTO</span><span class=\"token plain\"> my_table </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">VALUES</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">   </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">1</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'Hello'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">now</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">   </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">2</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'World'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">now</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">   </span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">3</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'Goodbye'</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">,</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">now</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>The file is stored in the <code>data</code> folder of your ClickHouse server - specifically in <code>/data/default/my_table</code> in a file named <code>data.Parquet</code>.</p><div class=\"theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw\"><div class=\"alert-icon admonitionIcon_Ibzs\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></div><div class=\"alert-content admonitionContent_vXIg\"><div class=\"admonitionHeading_TMsN\">note</div><p>Using the <code>File</code> table engine is incredibly handy for creating and querying files on your file system, but keep in mind that <code>File</code> tables are not <code>MergeTree</code> tables, so you don't get all the benefits that come with <code>MergeTree</code>. Use <code>File</code> for convenience when exporting data out of ClickHouse in convenient formats.</p></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"using-command-line-redirection\">Using Command-Line Redirection<a href=\"#using-command-line-redirection\" class=\"hash-link\" aria-label=\"Direct link to Using Command-Line Redirection\" title=\"Direct link to Using Command-Line Redirection\">​</a></h2><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">$ clickhouse-client --query </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT * from table\"</span><span class=\"token plain\"> --format FormatName </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">&gt;</span><span class=\"token plain\"> result.txt</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>See <a href=\"https://clickhouse.com/docs/en/interfaces/cli.md\" target=\"_blank\" rel=\"noopener noreferrer\">clickhouse-client</a>.</p>",
            "url": "https://clickhouse.com/docs/knowledgebase/file-export",
            "title": "How do I export data from ClickHouse to a file?",
            "summary": "Using INTO OUTFILE Clause",
            "date_modified": "2023-03-22T00:00:00.000Z",
            "tags": []
        },
        {
            "id": "https://clickhouse.com/docs/knowledgebase/ingest-parquet-files-in-s3",
            "content_html": "<p>Below are some basics of using the S3 table engine to read parquet files.</p><ul><li><p>create access and secret keys for an IAM service user.\nnormal login users usually don't work since they may have been configured with an MFA policy.</p></li><li><p>set the permissions on the policy to allow the service user to access the bucket and folders.</p></li></ul><p>The following is a very simple example that you can use to test the mechanics of accessing your parquet files successfully prior to applying to your actual data.</p><p>If you need an example of creating a user and bucket, you can follow the first two sections (create user and create bucket):\n<a href=\"https://clickhouse.com/docs/en/guides/sre/configuring-s3-for-clickhouse-use/\" target=\"_blank\" rel=\"noopener noreferrer\">https://clickhouse.com/docs/en/guides/sre/configuring-s3-for-clickhouse-use/</a></p><p>I used this sample file: <a href=\"https://github.com/Teradata/kylo/tree/master/samples/sample-data/parquet\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/Teradata/kylo/tree/master/samples/sample-data/parquet</a>\nand uploaded it to my test bucket</p><p>You can set the policy something like this on the bucket:\n(adjust as needed, this one is fairly open for privileges but will help in testing. you can narrow your permissions as necessary)</p><div class=\"codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    \"Version\": \"2012-10-17\",</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    \"Id\": \"Policy123456\",</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    \"Statement\": [</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        {</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            \"Sid\": \"abc123\",</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            \"Effect\": \"Allow\",</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            \"Principal\": {</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                \"AWS\": [</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                    \"arn:aws:iam::1234567890:user/mars-s3-user\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                ]</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            },</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            \"Action\": \"s3:*\",</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            \"Resource\": [</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                \"arn:aws:s3:::mars-doc-test\",</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">                \"arn:aws:s3:::mars-doc-test/*\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">            ]</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">        }</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    ]</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>You can run queries with this type of syntax using the S3 table engine:\n<a href=\"https://clickhouse.com/docs/en/sql-reference/table-functions/s3/\" target=\"_blank\" rel=\"noopener noreferrer\">https://clickhouse.com/docs/en/sql-reference/table-functions/s3/</a></p><div class=\"codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhouse-cloud :)  select count(*) from s3('https://mars-doc-test.s3.amazonaws.com/s3-parquet-test/userdata1.parquet','ABC123', 'abc+123', 'Parquet', 'first_name String');</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">SELECT count(*)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">FROM s3('https://mars-doc-test.s3.amazonaws.com/s3-parquet-test/userdata1.parquet', 'ABC123', 'abc+123', 'Parquet', 'first_name String')</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: fd4f1193-d604-4ac0-9a46-bdd2d5e14727</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─count()─┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│    1000 │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└─────────┘</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">1 row in set. Elapsed: 1.274 sec. Processed 1.00 thousand rows, 14.64 KB (784.81 rows/s., 11.49 KB/s.)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>The data types reference for parquet format are here:\n<a href=\"https://clickhouse.com/docs/en/interfaces/formats/#data-format-parquet\" target=\"_blank\" rel=\"noopener noreferrer\">https://clickhouse.com/docs/en/interfaces/formats/#data-format-parquet</a></p><p>To bring in the data into a native ClickHouse table:</p><p>create the table, something like this (just chose a couple of the columns in the parquet file):</p><div class=\"codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhouse-cloud :) CREATE TABLE my_parquet_table (id UInt64, first_name String) ENGINE = MergeTree ORDER BY id;</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">CREATE TABLE my_parquet_table</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">(</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    `id` UInt64,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    `first_name` String</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ENGINE = MergeTree</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ORDER BY id</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: 412e3994-bf8e-444e-ac43-a7c82642b7da</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Ok.</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">0 rows in set. Elapsed: 0.600 sec.</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Select the data from the S3 bucket to insert into the new table:</p><div class=\"codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhouse-cloud :) INSERT INTO my_parquet_table (id, first_name) SELECT id, first_name FROM s3('https://mars-doc-test.s3.amazonaws.com/s3-parquet-test/userdata1.parquet', 'ABC123','abc+123', 'Parquet', 'id UInt64, first_name String') FORMAT Parquet</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">INSERT INTO my_parquet_table (id, first_name) SELECT</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    id,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    first_name</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">FROM s3('https://mars-doc-test.s3.amazonaws.com/s3-parquet-test/userdata1.parquet', 'ABC123', 'abc+123', 'Parquet', 'id UInt64, first_name String')</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: c3cdc871-f338-462d-8797-6751b45a0b58</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Ok.</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">0 rows in set. Elapsed: 1.220 sec. Processed 1.00 thousand rows, 22.64 KB (819.61 rows/s., 18.56 KB/s.)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Verify the import:</p><div class=\"codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">clickhouse-cloud :) SELECT * FROM my_parquet_table LIMIT 10;</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">SELECT *</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">FROM my_parquet_table</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">LIMIT 10</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">Query id: 1ccf59dd-d804-46a9-aadd-ed5c57b9e1a0</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">┌─id─┬─first_name─┐</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│  1 │ Amanda     │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│  2 │ Albert     │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│  3 │ Evelyn     │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│  4 │ Denise     │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│  5 │ Carlos     │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│  6 │ Kathryn    │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│  7 │ Samuel     │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│  8 │ Harry      │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│  9 │ Jose       │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">│ 10 │ Emily      │</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">└────┴────────────┘</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>When you are ready to import your real data, you can use some special syntax like wildcards and ranges to specify your folders, subfolders and files in your bucket.\nI'd recommend to filter a few directories and files to test the import, maybe a certain year, a couple months and some date range to test first.</p><p>besides the path options here, newly released is syntax <code>**</code> which specifies all subdirectories recursively.\n<a href=\"https://clickhouse.com/docs/en/sql-reference/table-functions/s3/\" target=\"_blank\" rel=\"noopener noreferrer\">https://clickhouse.com/docs/en/sql-reference/table-functions/s3/</a></p><p>For example, assuming the paths and bucket structure is something like this:\n<code>https://your_s3_bucket.s3.amazonaws.com/&lt;your_folder&gt;/&lt;year&gt;/&lt;month&gt;/&lt;day&gt;/&lt;filename&gt;.parquet</code>\n<code>https://mars-doc-test.s3.amazonaws.com/system_logs/2022/11/01/my-app-logs-0001.parquet</code></p><p>This would get all files for 1st day of every month in 2021-2022\n<code>https://mars-doc-test.s3.amazonaws.com/system_logs/{2021-2022}/**/01/*.parquet</code></p>",
            "url": "https://clickhouse.com/docs/knowledgebase/ingest-parquet-files-in-s3",
            "title": "How to ingest Parquet files from an S3 bucket",
            "summary": "Below are some basics of using the S3 table engine to read parquet files.",
            "date_modified": "2023-03-22T00:00:00.000Z",
            "tags": []
        },
        {
            "id": "https://clickhouse.com/docs/knowledgebase/parquet-to-csv-json",
            "content_html": "<p>You can use <code>clickhouse-local</code> to convert files between any of the <a href=\"https://clickhouse.com/docs/en/interfaces/formats\" target=\"_blank\" rel=\"noopener noreferrer\">input and output formats</a> that ClickHouse supports (which is over 70 different formats!). In this article, we are convert a Parquet file in S3 into a CSV and JSON file.</p><p>Let's start at the beginning. ClickHouse has a collection of <a href=\"https://clickhouse.com/docs/en/sql-reference/table-functions/\" target=\"_blank\" rel=\"noopener noreferrer\">table functions</a> that read from files, databases and other resoures and converts the data to a table. To demonstrate, suppose we have a Parquet file in S3. We will use the <code>s3</code> table function to read it (ClickHouse knows it's a Parquet file based on the filename).</p><p>But first, let's download the <code>clickhouse</code> binary:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">curl</span><span class=\"token plain\"> https://clickhouse.com/ </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">sh</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"accessing-the-data-using-a-table-function\">Accessing the data using a table function<a href=\"#accessing-the-data-using-a-table-function\" class=\"hash-link\" aria-label=\"Direct link to Accessing the data using a table function\" title=\"Direct link to Accessing the data using a table function\">​</a></h2><p>Let's verify we can read the file by using <code>DESCRIBE</code> on the resulting table that the <code>s3</code> table function creates:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"DESCRIBE s3('https://datasets-documentation.s3.eu-west-3.amazonaws.com/house_parquet/house_0.parquet')\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>This particular file contains home prices of properties sold in the United Kingdom. The response looks like:</p><div class=\"language-response codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-response codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">price   Nullable(Int64)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">date    Nullable(UInt16)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">postcode1   Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">postcode2   Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">type    Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">is_new  Nullable(UInt8)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">duration    Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">addr1   Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">addr2   Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">street  Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">locality    Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">town    Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">district    Nullable(String)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">county  Nullable(String)</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>You can run any query you want on the data. For example, let's see which towns have the highest average price of homes:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">   town,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">   avg(price) AS avg_price</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">FROM s3('https://datasets-documentation.s3.eu-west-3.amazonaws.com/house_parquet/house_0.parquet')</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">GROUP BY town</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">ORDER BY avg_price DESC</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">LIMIT 10\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>The response looks like:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">GATWICK </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">16818750</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">CHALFONT ST GILES   </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">938090.0985915493</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">VIRGINIA WATER  </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">789301.1320224719</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">COBHAM  </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">699874.7111622555</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">BEACONSFIELD    </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">677247.5483146068</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ESHER   </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">616004.6888297872</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">KESTON  </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">607585.8597560975</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">GERRARDS CROSS  </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">566330.2959086584</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">ASCOT   </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">551491.2975753123</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">WEYBRIDGE   </span><span class=\"token number\" style=\"color:rgb(181, 206, 168)\">548974.828692494</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"convert-the-parquet-file-to-a-csv\">Convert the Parquet file to a CSV<a href=\"#convert-the-parquet-file-to-a-csv\" class=\"hash-link\" aria-label=\"Direct link to Convert the Parquet file to a CSV\" title=\"Direct link to Convert the Parquet file to a CSV\">​</a></h2><p>You can send the result of any SQL query to a file. Let's grab all the columns from our Parquet file in S3 and send the output to a new CSV file. Because the output file ends in <code>.csv</code>, ClickHouse knows to use the <code>CSV</code> output format:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT *</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">FROM s3('https://datasets-documentation.s3.eu-west-3.amazonaws.com/house_parquet/house_0.parquet')</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'house_prices.csv'\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Let's verify it worked:</p><div class=\"language-response codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-response codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">$ tail house_prices.csv</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">70000,10508,\"YO8\",\"9XN\",\"detached\",0,\"freehold\",\"7\",\"\",\"POPPY CLOSE\",\"SELBY\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">130000,14274,\"YO8\",\"9XP\",\"detached\",0,\"freehold\",\"10\",\"\",\"HEATHER CLOSE\",\"\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">150000,18180,\"YO8\",\"9XP\",\"detached\",0,\"freehold\",\"11\",\"\",\"HEATHER CLOSE\",\"\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">157000,18088,\"YO8\",\"9XP\",\"detached\",0,\"freehold\",\"12\",\"\",\"HEATHER CLOSE\",\"\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">134000,17333,\"YO8\",\"9XP\",\"semi-detached\",0,\"freehold\",\"16\",\"\",\"HEATHER CLOSE\",\"\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">250000,13405,\"YO8\",\"9YA\",\"detached\",0,\"freehold\",\"6\",\"\",\"YORKDALE COURT\",\"HAMBLETON\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">59500,11166,\"YO8\",\"9YB\",\"semi-detached\",0,\"freehold\",\"4\",\"\",\"YORKDALE DRIVE\",\"HAMBLETON\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">142500,17648,\"YO8\",\"9YB\",\"semi-detached\",0,\"freehold\",\"4A\",\"\",\"YORKDALE DRIVE\",\"HAMBLETON\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">230000,15125,\"YO8\",\"9YD\",\"detached\",0,\"freehold\",\"1\",\"\",\"ONE ACRE GARTH\",\"HAMBLETON\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">250000,15950,\"YO8\",\"9YD\",\"detached\",0,\"freehold\",\"3\",\"\",\"ONE ACRE GARTH\",\"HAMBLETON\",\"SELBY\",\"SELBY\",\"NORTH YORKSHIRE\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"convert-the-parquet-file-to-a-json\">Convert the Parquet file to a JSON<a href=\"#convert-the-parquet-file-to-a-json\" class=\"hash-link\" aria-label=\"Direct link to Convert the Parquet file to a JSON\" title=\"Direct link to Convert the Parquet file to a JSON\">​</a></h2><p>To convert the Parquet file to JSON, simply change the extension on the output filename:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT *</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">FROM s3('https://datasets-documentation.s3.eu-west-3.amazonaws.com/house_parquet/house_0.parquet')</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'house_prices.ndjson'\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>Let's verify it worked:</p><div class=\"language-response codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-response codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"> $ tail house_prices.ndjson</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"70000\",\"date\":10508,\"postcode1\":\"YO8\",\"postcode2\":\"9XN\",\"type\":\"detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"7\",\"addr2\":\"\",\"street\":\"POPPY CLOSE\",\"locality\":\"SELBY\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"130000\",\"date\":14274,\"postcode1\":\"YO8\",\"postcode2\":\"9XP\",\"type\":\"detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"10\",\"addr2\":\"\",\"street\":\"HEATHER CLOSE\",\"locality\":\"\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"150000\",\"date\":18180,\"postcode1\":\"YO8\",\"postcode2\":\"9XP\",\"type\":\"detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"11\",\"addr2\":\"\",\"street\":\"HEATHER CLOSE\",\"locality\":\"\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"157000\",\"date\":18088,\"postcode1\":\"YO8\",\"postcode2\":\"9XP\",\"type\":\"detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"12\",\"addr2\":\"\",\"street\":\"HEATHER CLOSE\",\"locality\":\"\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"134000\",\"date\":17333,\"postcode1\":\"YO8\",\"postcode2\":\"9XP\",\"type\":\"semi-detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"16\",\"addr2\":\"\",\"street\":\"HEATHER CLOSE\",\"locality\":\"\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"250000\",\"date\":13405,\"postcode1\":\"YO8\",\"postcode2\":\"9YA\",\"type\":\"detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"6\",\"addr2\":\"\",\"street\":\"YORKDALE COURT\",\"locality\":\"HAMBLETON\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"59500\",\"date\":11166,\"postcode1\":\"YO8\",\"postcode2\":\"9YB\",\"type\":\"semi-detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"4\",\"addr2\":\"\",\"street\":\"YORKDALE DRIVE\",\"locality\":\"HAMBLETON\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"142500\",\"date\":17648,\"postcode1\":\"YO8\",\"postcode2\":\"9YB\",\"type\":\"semi-detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"4A\",\"addr2\":\"\",\"street\":\"YORKDALE DRIVE\",\"locality\":\"HAMBLETON\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"230000\",\"date\":15125,\"postcode1\":\"YO8\",\"postcode2\":\"9YD\",\"type\":\"detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"1\",\"addr2\":\"\",\"street\":\"ONE ACRE GARTH\",\"locality\":\"HAMBLETON\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">{\"price\":\"250000\",\"date\":15950,\"postcode1\":\"YO8\",\"postcode2\":\"9YD\",\"type\":\"detached\",\"is_new\":0,\"duration\":\"freehold\",\"addr1\":\"3\",\"addr2\":\"\",\"street\":\"ONE ACRE GARTH\",\"locality\":\"HAMBLETON\",\"town\":\"SELBY\",\"district\":\"SELBY\",\"county\":\"NORTH YORKSHIRE\"}</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"convert-csv-to-parquet\">Convert CSV to Parquet<a href=\"#convert-csv-to-parquet\" class=\"hash-link\" aria-label=\"Direct link to Convert CSV to Parquet\" title=\"Direct link to Convert CSV to Parquet\">​</a></h2><p>It works both ways - we can easily read in the new CSV file and output it into a Parquet file. The local file <code>house_prices.csv</code> can be read in ClickHouse using the <code>file</code> table function, and ClickHouse outputs the file in Parquet format based on the filename ending in <code>.parquet</code> (or we could have added the <code>FORMAT Parquet</code> clause):</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT *</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">FROM file('house_prices.csv')</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'house_prices.parquet'\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>As we mentioned above, you can use any of the ClickHouse <a href=\"https://clickhouse.com/docs/en/interfaces/formats\" target=\"_blank\" rel=\"noopener noreferrer\">input and output formats</a> along with <code>clickhouse local</code> to easily convert files into different formats.</p>",
            "url": "https://clickhouse.com/docs/knowledgebase/parquet-to-csv-json",
            "title": "Converting Files from Parquet to CSV or JSON",
            "summary": "You can use clickhouse-local to convert files between any of the input and output formats that ClickHouse supports (which is over 70 different formats!). In this article, we are convert a Parquet file in S3 into a CSV and JSON file.",
            "date_modified": "2023-03-22T00:00:00.000Z",
            "tags": []
        },
        {
            "id": "https://clickhouse.com/docs/knowledgebase/postgresql-to-parquet-csv-json",
            "content_html": "<p>This one is easy with <code>clickhouse-local</code>:</p><ul><li>Use the <a href=\"https://clickhouse.com/docs/en/sql-reference/table-functions/postgresql\" target=\"_blank\" rel=\"noopener noreferrer\"><code>postgresql</code> table function</a> to read the data</li><li>Use the <code>INTO OUTFILE _filename_ FORMAT</code> clause and specify the desired output format</li></ul><p>The output format can be any of the supported <a href=\"https://clickhouse.com/docs/en/interfaces/formats\" target=\"_blank\" rel=\"noopener noreferrer\">ouput formats</a> in ClickHouse. Let's look at a few examples...</p><p>These examples use <code>clickhouse-local</code>, which is a part of the ClickHouse binary. Download it using the following:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">curl</span><span class=\"token plain\"> https://clickhouse.com/ </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">sh</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"export-postgresql-to-parquet\">Export PostgreSQL to Parquet<a href=\"#export-postgresql-to-parquet\" class=\"hash-link\" aria-label=\"Direct link to Export PostgreSQL to Parquet\" title=\"Direct link to Export PostgreSQL to Parquet\">​</a></h2><p>The <code>postgresql</code> table function allows <code>SELECT</code> (and <code>INSERT</code>) queries to be performed on data that is stored on a remote PostgreSQL server. For example, to view the entire contents of a table in PostgreSQL:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">SELECT *</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">   postgresql</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'localhost:5432'</span><span class=\"token plain\">,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'postgres_database'</span><span class=\"token plain\">,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'postgres_table'</span><span class=\"token plain\">,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'user'</span><span class=\"token plain\">,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'password'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>We can pipe the output of this query to a file using <code>INTO OUTFILE</code>. Use <code>FORMAT</code> to specify the format of the file to be created. Let's grab the entire contents of the PostgreSQL table, and send its contents to a Parquet file:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT * FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">   postgresql(</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'localhost:5432',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'postgres_database',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'postgres_table',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'user',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'password'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'my_output_file.parquet'\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw\"><div class=\"alert-icon admonitionIcon_Ibzs\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></div><div class=\"alert-content admonitionContent_vXIg\"><div class=\"admonitionHeading_TMsN\">note</div><p>Because the name of the output file has a <code>.parquet</code> extension, ClickHouse assumes we want the Parquet format, so notice we omitted the <code>FORMAT Parquet</code> clause.</p></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"export-postgresql-to-csv\">Export PostgreSQL to CSV<a href=\"#export-postgresql-to-csv\" class=\"hash-link\" aria-label=\"Direct link to Export PostgreSQL to CSV\" title=\"Direct link to Export PostgreSQL to CSV\">​</a></h2><p>It's the same as for Parquet, except we specify a more approriate filename for the output:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT * FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">   postgresql(</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'localhost:5432',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'postgres_database',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'postgres_table',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'user',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'password'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'my_output_file.csv'\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>That's it! ClickHouse sees the <code>.csv</code> extension on the output file name and outputs the data as comma-separated. Otherwise, it's the exact same command as above.</p><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"export-postgresql-to-json\">Export PostgreSQL to JSON<a href=\"#export-postgresql-to-json\" class=\"hash-link\" aria-label=\"Direct link to Export PostgreSQL to JSON\" title=\"Direct link to Export PostgreSQL to JSON\">​</a></h2><p>To go from PostgreSQL to JSON, we just change the filename and ClickHouse will figure out the format:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT * FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">   postgresql(</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'localhost:5432',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'postgres_database',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'postgres_table',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'user',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'password'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'my_output_file.ndjson'\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw\"><div class=\"alert-icon admonitionIcon_Ibzs\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></div><div class=\"alert-content admonitionContent_vXIg\"><div class=\"admonitionHeading_TMsN\">note</div><p>You don't have to stop here - you can use <code>clickhouse-local</code> to pull data from PostgreSQL and send it to <a href=\"https://clickhouse.com/docs/en/sql-reference/formats/\" target=\"_blank\" rel=\"noopener noreferrer\">all types of output formats</a>.</p><p>If ClickHouse can not determine the output type by the filename extension, or if you want to specifically choose a format, add the <code>FOMRAT</code> clause:</p><div class=\"language-sql codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-sql codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token identifier punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">`</span><span class=\"token plain\">bash</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">.</span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">/</span><span class=\"token plain\">clickhouse </span><span class=\"token keyword\" style=\"color:rgb(86, 156, 214)\">local</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">-</span><span class=\"token plain\">q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT * FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">   postgresql(</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'localhost:5432',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'postgres_database',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'postgres_table',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'user',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'password'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'my_output_file.ndjson'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">FORMAT JSONEachRow\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"stream-postgresql-to-another-process\">Stream PostgreSQL to another process<a href=\"#stream-postgresql-to-another-process\" class=\"hash-link\" aria-label=\"Direct link to Stream PostgreSQL to another process\" title=\"Direct link to Stream PostgreSQL to another process\">​</a></h2><p>Instead of using <code>INTO OUTFILE</code>, you can stream the results of a table function to another process. Here's a simple example to demonstrate the syntax - we count the number of rows using the Linux <code>wc -l</code> command:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT *</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">FROM s3('https://datasets-documentation.s3.eu-west-3.amazonaws.com/house_parquet/house_0.parquet'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">FORMAT JSONEachRow</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">)\"</span><span class=\"token plain\"> </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">wc</span><span class=\"token plain\"> -l</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>However, we could easily stream the rows to a shell script, Python script, or any other process that you want.</p>",
            "url": "https://clickhouse.com/docs/knowledgebase/postgresql-to-parquet-csv-json",
            "title": "Export PostgreSQL data to Parquet, CSV or JSON",
            "summary": "This one is easy with clickhouse-local:",
            "date_modified": "2023-03-22T00:00:00.000Z",
            "tags": []
        },
        {
            "id": "https://clickhouse.com/docs/knowledgebase/mysql-to-parquet-csv-json",
            "content_html": "<p>The <code>clickhouse-local</code> tool makes it quick and easy to read data from MySQL and output the data into lots of different formats, including Parquet, CSV, and JSON. We are going to:</p><ul><li>Use the <a href=\"https://clickhouse.com/docs/en/sql-reference/table-functions/mysql\" target=\"_blank\" rel=\"noopener noreferrer\"><code>mysql</code> table function</a> to read the data</li><li>Use the <code>INTO OUTFILE _filename_ FORMAT</code> clause and specify the desired output format</li></ul><p>The <code>clickhouse-local</code> tool is a part of the ClickHouse binary. Download it using the following:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">curl</span><span class=\"token plain\"> https://clickhouse.com/ </span><span class=\"token operator\" style=\"color:rgb(212, 212, 212)\">|</span><span class=\"token plain\"> </span><span class=\"token function\" style=\"color:rgb(220, 220, 170)\">sh</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"export-mysql-to-parquet\">Export MySQL to Parquet<a href=\"#export-mysql-to-parquet\" class=\"hash-link\" aria-label=\"Direct link to Export MySQL to Parquet\" title=\"Direct link to Export MySQL to Parquet\">​</a></h2><p>The <code>mysql</code> table function creates a table based on the results of a query sent to a MySQL instance. For example:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">SELECT *</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">   mysql</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">(</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'localhost:3306'</span><span class=\"token plain\">,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'my_sql_database'</span><span class=\"token plain\">,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'my_sql_table'</span><span class=\"token plain\">,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'user'</span><span class=\"token plain\">,</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">    </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">'password'</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">)</span><span class=\"token punctuation\" style=\"color:rgb(212, 212, 212)\">;</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>We can pipe the output of this query to a file using <code>INTO OUTFILE</code>. Use <code>FORMAT</code> to specify the format of the file to be created. Let's grab the entire contents of a MySQL table, and send its contents to a Parquet file:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT * FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">   mysql(</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'localhost:3306',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'my_sql_database',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'my_sql_table',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'user',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'password'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'my_output_file.parquet'\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><div class=\"theme-admonition theme-admonition-note alert alert--secondary admonition_WoCw\"><div class=\"alert-icon admonitionIcon_Ibzs\"><svg viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></div><div class=\"alert-content admonitionContent_vXIg\"><div class=\"admonitionHeading_TMsN\">note</div><p>Because the name of the output file has a <code>.parquet</code> extension, ClickHouse assumes we want the Parquet format, so notice we omitted the <code>FORMAT Parquet</code> clause.</p></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"export-mysql-to-csv\">Export MySQL to CSV<a href=\"#export-mysql-to-csv\" class=\"hash-link\" aria-label=\"Direct link to Export MySQL to CSV\" title=\"Direct link to Export MySQL to CSV\">​</a></h2><p>It's the same as for Parquet, except this time we use a <code>.csv</code> extension on the filename. ClickHouse will realize we want a comma-separated output and that's how the data will be written to the file:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT * FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">   mysql(</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'localhost:3306',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'my_sql_database',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'my_sql_table',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'user',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'password'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'my_output_file.csv'\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><h2 class=\"anchor anchorWithStickyNavbar_LWe7\" id=\"export-mysql-to-json\">Export MySQL to JSON<a href=\"#export-mysql-to-json\" class=\"hash-link\" aria-label=\"Direct link to Export MySQL to JSON\" title=\"Direct link to Export MySQL to JSON\">​</a></h2><p>To go from MySQL to JSON, just change the extension on the filename to <code>jsonl</code> or <code>ndjson</code>:</p><div class=\"language-bash codeBlockContainer_APcc theme-code-block\"><div class=\"codeBlockContent_biex\"><pre tabindex=\"0\" class=\"prism-code language-bash codeBlock_bY9V thin-scrollbar\"><code class=\"codeBlockLines_e6Vv\"><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token plain\">./clickhouse </span><span class=\"token builtin class-name\" style=\"color:rgb(78, 201, 176)\">local</span><span class=\"token plain\"> -q </span><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">\"SELECT * FROM</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">   mysqlql(</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'localhost:3306',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'my_sql_database',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'my_sql_table',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'user',</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">    'password'</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">)</span><br></span><span class=\"token-line\" style=\"color:#9CDCFE\"><span class=\"token string\" style=\"color:rgb(206, 145, 120)\">INTO OUTFILE 'my_output_file.ndjson'\"</span><br></span></code></pre><div class=\"buttonGroup__atx\"><button type=\"button\" aria-label=\"Copy code to clipboard\" title=\"Copy\" class=\"clean-btn\"><span class=\"copyButtonIcons_eSgA\" aria-hidden=\"true\"><svg class=\"copyButtonIcon_y97N\" viewBox=\"0 0 24 24\"><path d=\"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z\"></path></svg><svg class=\"copyButtonSuccessIcon_LjdS\" viewBox=\"0 0 24 24\"><path d=\"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z\"></path></svg></span></button></div></div></div><p>It's impressive how simple yet powerful the <code>clickhouse-local</code> tool really is. You can easily read data from a database like MySQL and output it into <a href=\"https://clickhouse.com/docs/en/sql-reference/formats/\" target=\"_blank\" rel=\"noopener noreferrer\">all types of different output formats</a>.</p>",
            "url": "https://clickhouse.com/docs/knowledgebase/mysql-to-parquet-csv-json",
            "title": "Export MySQL data to Parquet, CSV or JSON",
            "summary": "The clickhouse-local tool makes it quick and easy to read data from MySQL and output the data into lots of different formats, including Parquet, CSV, and JSON. We are going to:",
            "date_modified": "2023-03-21T00:00:00.000Z",
            "tags": []
        }
    ]
}
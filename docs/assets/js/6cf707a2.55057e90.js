"use strict";(self.webpackChunknew_nav_docusaurus_2_2=self.webpackChunknew_nav_docusaurus_2_2||[]).push([[21328],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>k});var o=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},l=Object.keys(e);for(o=0;o<l.length;o++)t=l[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)t=l[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var r=o.createContext({}),u=function(e){var n=o.useContext(r),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=u(e.components);return o.createElement(r.Provider,{value:n},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,l=e.originalType,r=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),c=u(t),m=a,k=c["".concat(r,".").concat(m)]||c[m]||p[m]||l;return t?o.createElement(k,s(s({ref:n},d),{},{components:t})):o.createElement(k,s({ref:n},d))}));function k(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var l=t.length,s=new Array(l);s[0]=m;var i={};for(var r in n)hasOwnProperty.call(n,r)&&(i[r]=n[r]);i.originalType=e,i[c]="string"==typeof e?e:a,s[1]=i;for(var u=2;u<l;u++)s[u]=t[u];return o.createElement.apply(null,s)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},69166:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>u});var o=t(87462),a=(t(67294),t(3905));const l={slug:"/en/getting-started/example-datasets/youtube-dislikes",sidebar_label:"YouTube Dislikes",description:"A collection is dislikes of YouTube videos."},s="YouTube dataset of dislikes",i={unversionedId:"en/getting-started/example-datasets/youtube-dislikes",id:"en/getting-started/example-datasets/youtube-dislikes",title:"YouTube dataset of dislikes",description:"A collection is dislikes of YouTube videos.",source:"@site/docs/en/getting-started/example-datasets/youtube-dislikes.md",sourceDirName:"en/getting-started/example-datasets",slug:"/en/getting-started/example-datasets/youtube-dislikes",permalink:"/docs/en/getting-started/example-datasets/youtube-dislikes",draft:!1,editUrl:"https://github.com/ClickHouse/ClickHouse/tree/master/docs/en/getting-started/example-datasets/youtube-dislikes.md",tags:[],version:"current",frontMatter:{slug:"/en/getting-started/example-datasets/youtube-dislikes",sidebar_label:"YouTube Dislikes",description:"A collection is dislikes of YouTube videos."},sidebar:"docs",previous:{title:"WikiStat",permalink:"/docs/en/getting-started/example-datasets/wikistat"},next:{title:"Integrations",permalink:"/docs/en/integrations"}},r={},u=[{value:"Step-by-step instructions",id:"step-by-step-instructions",level:2},{value:"Questions",id:"questions",level:2},{value:"If someone disables comments does it lower the chance someone will actually click like or dislike?",id:"if-someone-disables-comments-does-it-lower-the-chance-someone-will-actually-click-like-or-dislike",level:3},{value:"How does the number of videos change over time - notable events?",id:"how-does-the-number-of-videos-change-over-time---notable-events",level:3},{value:"More subtitiles over time and when",id:"more-subtitiles-over-time-and-when",level:3},{value:"Top uploaders over time",id:"top-uploaders-over-time",level:3},{value:"How do like ratio changes as views go up?",id:"how-do-like-ratio-changes-as-views-go-up",level:3},{value:"How are views distributed?",id:"how-are-views-distributed",level:3}],d={toc:u},c="wrapper";function p(e){let{components:n,...t}=e;return(0,a.kt)(c,(0,o.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"youtube-dataset-of-dislikes"},"YouTube dataset of dislikes"),(0,a.kt)("p",null,"In November of 2021, YouTube removed the public ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"dislike"))," count from all of its videos. While creators can still see the number of dislikes, viewers can only see how many ",(0,a.kt)("strong",{parentName:"p"},(0,a.kt)("em",{parentName:"strong"},"likes"))," a video has received."),(0,a.kt)("admonition",{type:"important"},(0,a.kt)("p",{parentName:"admonition"},"The dataset has over 4.55 billion records, so be careful just copying-and-pasting the commands below unless your resources can handle that type of volume. The commands below were executed on a ",(0,a.kt)("strong",{parentName:"p"},"Production")," instance of ",(0,a.kt)("a",{parentName:"p",href:"https://clickhouse.cloud"},"ClickHouse Cloud"),".")),(0,a.kt)("p",null,"The data is in a JSON format and can be downloaded from ",(0,a.kt)("a",{parentName:"p",href:"https://archive.org/download/dislikes_youtube_2021_12_video_json_files"},"archive.org"),". We have made this same data available in S3 so that it can be downloaded more efficiently into a ClickHouse Cloud instance."),(0,a.kt)("p",null,"Here are the steps to create a table in ClickHouse Cloud and insert the data."),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The steps below will easily work on a local install of ClickHouse too. The only change would be to use the ",(0,a.kt)("inlineCode",{parentName:"p"},"s3")," function instead of ",(0,a.kt)("inlineCode",{parentName:"p"},"s3cluster")," (unless you have a cluster configured - in which case change ",(0,a.kt)("inlineCode",{parentName:"p"},"default")," to the name of your cluster).")),(0,a.kt)("h2",{id:"step-by-step-instructions"},"Step-by-step instructions"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Let's see what the data looks like. The ",(0,a.kt)("inlineCode",{parentName:"li"},"s3cluster")," table function returns a table, so we can ",(0,a.kt)("inlineCode",{parentName:"li"},"DESCRIBE")," the reult:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"DESCRIBE s3Cluster(\n    'default',\n    'https://clickhouse-public-datasets.s3.amazonaws.com/youtube/original/files/*.zst',\n    'JSONLines'\n);\n")),(0,a.kt)("p",null,"ClickHouse infers the following schema from the JSON file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\u250c\u2500name\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500type\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 id                  \u2502 Nullable(String)                     \u2502\n\u2502 fetch_date          \u2502 Nullable(Int64)                      \u2502\n\u2502 upload_date         \u2502 Nullable(String)                     \u2502\n\u2502 title               \u2502 Nullable(String)                     \u2502\n\u2502 uploader_id         \u2502 Nullable(String)                     \u2502\n\u2502 uploader            \u2502 Nullable(String)                     \u2502\n\u2502 uploader_sub_count  \u2502 Nullable(Int64)                      \u2502\n\u2502 is_age_limit        \u2502 Nullable(Bool)                       \u2502\n\u2502 view_count          \u2502 Nullable(Int64)                      \u2502\n\u2502 like_count          \u2502 Nullable(Int64)                      \u2502\n\u2502 dislike_count       \u2502 Nullable(Int64)                      \u2502\n\u2502 is_crawlable        \u2502 Nullable(Bool)                       \u2502\n\u2502 is_live_content     \u2502 Nullable(Bool)                       \u2502\n\u2502 has_subtitles       \u2502 Nullable(Bool)                       \u2502\n\u2502 is_ads_enabled      \u2502 Nullable(Bool)                       \u2502\n\u2502 is_comments_enabled \u2502 Nullable(Bool)                       \u2502\n\u2502 description         \u2502 Nullable(String)                     \u2502\n\u2502 rich_metadata       \u2502 Array(Map(String, Nullable(String))) \u2502\n\u2502 super_titles        \u2502 Array(Map(String, Nullable(String))) \u2502\n\u2502 uploader_badges     \u2502 Nullable(String)                     \u2502\n\u2502 video_badges        \u2502 Nullable(String)                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Based on the inferred schema, we cleaned up the data types and added a primary key. Define the following table:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"CREATE TABLE youtube\n(\n    `id` String,\n    `fetch_date` DateTime,\n    `upload_date` String,\n    `title` String,\n    `uploader_id` String,\n    `uploader` String,\n    `uploader_sub_count` Int64,\n    `is_age_limit` Bool,\n    `view_count` Int64,\n    `like_count` Int64,\n    `dislike_count` Int64,\n    `is_crawlable` Bool,\n    `has_subtitles` Bool,\n    `is_ads_enabled` Bool,\n    `is_comments_enabled` Bool,\n    `description` String,\n    `rich_metadata` Array(Map(String, String)),\n    `super_titles` Array(Map(String, String)),\n    `uploader_badges` String,\n    `video_badges` String\n)\nENGINE = MergeTree\nORDER BY (upload_date, uploader);\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"The following command streams the records from the S3 files into the ",(0,a.kt)("inlineCode",{parentName:"li"},"youtube")," table.")),(0,a.kt)("admonition",{type:"important"},(0,a.kt)("p",{parentName:"admonition"},"This inserts a lot of data - 4.65 billion rows. If you do not want the entire dataset, simply add a ",(0,a.kt)("inlineCode",{parentName:"p"},"LIMIT")," clause with the desired number of rows.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"INSERT INTO youtube\nSETTINGS input_format_null_as_default = 1\nSELECT\n    id,\n    parseDateTimeBestEffortUS(toString(fetch_date)) AS fetch_date,\n    upload_date,\n    ifNull(title, '') AS title,\n    uploader_id,\n    ifNull(uploader, '') AS uploader,\n    uploader_sub_count,\n    is_age_limit,\n    view_count,\n    like_count,\n    dislike_count,\n    is_crawlable,\n    has_subtitles,\n    is_ads_enabled,\n    is_comments_enabled,\n    ifNull(description, '') AS description,\n    rich_metadata,\n    super_titles,\n    ifNull(uploader_badges, '') AS uploader_badges,\n    ifNull(video_badges, '') AS video_badges\nFROM s3Cluster(\n       'default',\n       'https://clickhouse-public-datasets.s3.amazonaws.com/youtube/original/files/*.zst',\n       'JSONLines'\n    );\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"Open a new tab in the SQL Console of ClickHouse Cloud (or a new ",(0,a.kt)("inlineCode",{parentName:"li"},"clickhouse-client")," window) and watch the count increase. It will take a while to insert 4.56B rows, depending on your server resources. (Withtout any tweaking of settings, it takes about 4.5 hours.)")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT formatReadableQuantity(count())\nFROM youtube\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\u250c\u2500formatReadableQuantity(count())\u2500\u2510\n\u2502 4.56 billion                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Once the data is inserted, go ahead and count the number of dislikes of your favorite videos or channels. Let's see how many videos were uploaded by ClickHouse:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT count()\nFROM youtube\nWHERE uploader = 'ClickHouse';\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\u250c\u2500count()\u2500\u2510\n\u2502      84 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n1 row in set. Elapsed: 0.570 sec. Processed 237.57 thousand rows, 5.77 MB (416.54 thousand rows/s., 10.12 MB/s.)\n")),(0,a.kt)("admonition",{type:"note"},(0,a.kt)("p",{parentName:"admonition"},"The query above runs so quickly because we chose ",(0,a.kt)("inlineCode",{parentName:"p"},"uploader")," as the first column of the primary key - so it only had to process 237k rows.")),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},"Let's look and likes and dislikes of ClickHouse videos:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    title,\n    like_count,\n    dislike_count\nFROM youtube\nWHERE uploader = 'ClickHouse'\nORDER BY dislike_count DESC;\n")),(0,a.kt)("p",null,"The response looks like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\u250c\u2500title\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500like_count\u2500\u252c\u2500dislike_count\u2500\u2510\n\u2502 ClickHouse v21.11 Release Webinar                                                                    \u2502         52 \u2502             3 \u2502\n\u2502 ClickHouse Introduction                                                                              \u2502         97 \u2502             3 \u2502\n\u2502 Casa Modelo Algarve                                                                                  \u2502        180 \u2502             3 \u2502\n\u2502 \u041f\u0440\u043e\u0444\u0430\u0439\u043b\u0435\u0440 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432:  \u0442\u0440\u0443\u0434\u043d\u044b\u0439 \u043f\u0443\u0442\u044c                                                                    \u2502         33 \u2502             3 \u2502\n\u2502 ClickHouse \u0432 \u041a\u0443\u0440\u0441\u043e\u043c\u0435\u0442\u0440\u0435                                                                              \u2502          4 \u2502             2 \u2502\n\u2502 10 Good Reasons to Use ClickHouse                                                                    \u2502         27 \u2502             2 \u2502\n...\n\n84 rows in set. Elapsed: 0.013 sec. Processed 155.65 thousand rows, 16.94 MB (11.96 million rows/s., 1.30 GB/s.)\n")),(0,a.kt)("ol",{start:7},(0,a.kt)("li",{parentName:"ol"},"Here is a search for videos with ",(0,a.kt)("strong",{parentName:"li"},"ClickHouse")," in the ",(0,a.kt)("inlineCode",{parentName:"li"},"title")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"description")," fields:")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    view_count,\n    like_count,\n    dislike_count,\n    concat('https://youtu.be/', id) AS url,\n    title\nFROM youtube\nWHERE (title ILIKE '%ClickHouse%') OR (description ILIKE '%ClickHouse%')\nORDER BY\n    like_count DESC,\n    view_count DESC\n")),(0,a.kt)("p",null,"This query has to process every row, and also parse through two columns of strings. Even then, we get decent performance at 4.15M rows/second:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"1174 rows in set. Elapsed: 1099.368 sec. Processed 4.56 billion rows, 1.98 TB (4.15 million rows/s., 1.80 GB/s.)\n")),(0,a.kt)("p",null,"The results look like:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\u250c\u2500view_count\u2500\u252c\u2500like_count\u2500\u252c\u2500dislike_count\u2500\u252c\u2500url\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500title\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502       1919 \u2502         63 \u2502             1 \u2502 https://youtu.be/b9MeoOtAivQ \u2502 ClickHouse v21.10 Release Webinar                                                                      \u2502\n\u2502       8710 \u2502         62 \u2502             4 \u2502 https://youtu.be/PeV1mC2z--M \u2502 What is JDBC DriverManager? | JDBC                                                                     \u2502\n\u2502       3534 \u2502         62 \u2502             1 \u2502 https://youtu.be/8nWRhK9gw10 \u2502 CLICKHOUSE - Arquitetura Modular                                                                       \u2502\n")),(0,a.kt)("h2",{id:"questions"},"Questions"),(0,a.kt)("h3",{id:"if-someone-disables-comments-does-it-lower-the-chance-someone-will-actually-click-like-or-dislike"},"If someone disables comments does it lower the chance someone will actually click like or dislike?"),(0,a.kt)("p",null,"When commenting is disabled, are people more likely to like or dislike to express their feelings about a video?"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    concat('< ', formatReadableQuantity(view_range)) AS views,\n    is_comments_enabled,\n    total_clicks / num_views AS prob_like_dislike\nFROM\n(\n    SELECT\n        is_comments_enabled,\n        power(10, CEILING(log10(view_count + 1))) AS view_range,\n        sum(like_count + dislike_count) AS total_clicks,\n        sum(view_count) AS num_views\n    FROM youtube\n    GROUP BY\n        view_range,\n        is_comments_enabled\n) WHERE view_range > 1\nORDER BY\n    is_comments_enabled ASC,\n    num_views ASC\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\n\u250c\u2500views\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500is_comments_enabled\u2500\u252c\u2500\u2500\u2500\u2500prob_like_dislike\u2500\u2510\n\u2502 < 10.00           \u2502 false               \u2502  0.08224180712685371 \u2502\n\u2502 < 100.00          \u2502 false               \u2502  0.06346337759167248 \u2502\n\u2502 < 1.00 thousand   \u2502 false               \u2502  0.03201883652987105 \u2502\n\u2502 < 10.00 thousand  \u2502 false               \u2502  0.01716073540410903 \u2502\n\u2502 < 10.00 billion   \u2502 false               \u2502 0.004555639481829971 \u2502\n\u2502 < 100.00 thousand \u2502 false               \u2502  0.01293351460515323 \u2502\n\u2502 < 1.00 billion    \u2502 false               \u2502 0.004761811192464957 \u2502\n\u2502 < 1.00 million    \u2502 false               \u2502 0.010472604018980551 \u2502\n\u2502 < 10.00 million   \u2502 false               \u2502  0.00788902538420125 \u2502\n\u2502 < 100.00 million  \u2502 false               \u2502  0.00579152804250582 \u2502\n\u2502 < 10.00           \u2502 true                \u2502  0.09819517478134059 \u2502\n\u2502 < 100.00          \u2502 true                \u2502  0.07403784478585775 \u2502\n\u2502 < 1.00 thousand   \u2502 true                \u2502  0.03846294910067627 \u2502\n\u2502 < 10.00 billion   \u2502 true                \u2502 0.005615217329358215 \u2502\n\u2502 < 10.00 thousand  \u2502 true                \u2502  0.02505881391701455 \u2502\n\u2502 < 1.00 billion    \u2502 true                \u2502 0.007434998802482997 \u2502\n\u2502 < 100.00 thousand \u2502 true                \u2502 0.022694648130822004 \u2502\n\u2502 < 100.00 million  \u2502 true                \u2502 0.011761563746575625 \u2502\n\u2502 < 1.00 million    \u2502 true                \u2502 0.020776022304589435 \u2502\n\u2502 < 10.00 million   \u2502 true                \u2502 0.016917095718089584 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n22 rows in set. Elapsed: 8.460 sec. Processed 4.56 billion rows, 77.48 GB (538.73 million rows/s., 9.16 GB/s.)\n\n")),(0,a.kt)("p",null,"Enabling comments seems to be correlated with a higher rate of engagement."),(0,a.kt)("h3",{id:"how-does-the-number-of-videos-change-over-time---notable-events"},"How does the number of videos change over time - notable events?"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    toStartOfMonth(toDateTime(upload_date)) AS month,\n    uniq(uploader_id) AS uploaders, \n    count() as num_videos, \n    sum(view_count) as view_count\nFROM youtube\nWHERE (month >= '2005-01-01') AND (month < '2021-12-01')\nGROUP BY month\nORDER BY month ASC\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\u250c\u2500\u2500\u2500\u2500\u2500\u2500month\u2500\u252c\u2500uploaders\u2500\u252c\u2500num_videos\u2500\u252c\u2500\u2500\u2500view_count\u2500\u2510\n\u2502 2005-04-01 \u2502         5 \u2502          6 \u2502    213597737 \u2502\n\u2502 2005-05-01 \u2502         6 \u2502          9 \u2502      2944005 \u2502\n\u2502 2005-06-01 \u2502       165 \u2502        351 \u2502     18624981 \u2502\n\u2502 2005-07-01 \u2502       395 \u2502       1168 \u2502     94164872 \u2502\n\u2502 2005-08-01 \u2502      1171 \u2502       3128 \u2502    124540774 \u2502\n\u2502 2005-09-01 \u2502      2418 \u2502       5206 \u2502    475536249 \u2502\n\u2502 2005-10-01 \u2502      6750 \u2502      13747 \u2502    737593613 \u2502\n\u2502 2005-11-01 \u2502     13706 \u2502      28078 \u2502   1896116976 \u2502\n\u2502 2005-12-01 \u2502     24756 \u2502      49885 \u2502   2478418930 \u2502\n\u2502 2006-01-01 \u2502     49992 \u2502     100447 \u2502   4532656581 \u2502\n\u2502 2006-02-01 \u2502     67882 \u2502     138485 \u2502   5677516317 \u2502\n\u2502 2006-03-01 \u2502    103358 \u2502     212237 \u2502   8430301366 \u2502\n\u2502 2006-04-01 \u2502    114615 \u2502     234174 \u2502   9980760440 \u2502\n\u2502 2006-05-01 \u2502    152682 \u2502     332076 \u2502  14129117212 \u2502\n\u2502 2006-06-01 \u2502    193962 \u2502     429538 \u2502  17014143263 \u2502\n\u2502 2006-07-01 \u2502    234401 \u2502     530311 \u2502  18721143410 \u2502\n\u2502 2006-08-01 \u2502    281280 \u2502     614128 \u2502  20473502342 \u2502\n\u2502 2006-09-01 \u2502    312434 \u2502     679906 \u2502  23158422265 \u2502\n\u2502 2006-10-01 \u2502    404873 \u2502     897590 \u2502  27357846117 \u2502\n")),(0,a.kt)("p",null,"A spike of uploaders ",(0,a.kt)("a",{parentName:"p",href:"https://www.theverge.com/2020/3/27/21197642/youtube-with-me-style-videos-views-coronavirus-cook-workout-study-home-beauty"},"around covid is noticeable"),"."),(0,a.kt)("h3",{id:"more-subtitiles-over-time-and-when"},"More subtitiles over time and when"),(0,a.kt)("p",null,"With advances in speech recognition, it\u2019s easier than ever to create subtitles for video with youtube adding auto-captioning in late 2009 - was the jump then?"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    toStartOfMonth(upload_date) AS month,\n    countIf(has_subtitles) / count() AS percent_subtitles,\n    percent_subtitles - any(percent_subtitles) OVER (ORDER BY month ASC ROWS BETWEEN 1 PRECEDING AND 1 PRECEDING) AS previous\nFROM youtube\nWHERE (month >= '2015-01-01') AND (month < '2021-12-02')\nGROUP BY month\nORDER BY month ASC\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\u250c\u2500\u2500\u2500\u2500\u2500\u2500month\u2500\u252c\u2500\u2500\u2500percent_subtitles\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500previous\u2500\u2510\n\u2502 2015-01-01 \u2502  0.2652653881082824 \u2502      0.2652653881082824 \u2502\n\u2502 2015-02-01 \u2502  0.3147556050309162 \u2502    0.049490216922633834 \u2502\n\u2502 2015-03-01 \u2502 0.32460464492371877 \u2502    0.009849039892802558 \u2502\n\u2502 2015-04-01 \u2502 0.33471963051468445 \u2502    0.010114985590965686 \u2502\n\u2502 2015-05-01 \u2502  0.3168087575501062 \u2502   -0.017910872964578273 \u2502\n\u2502 2015-06-01 \u2502  0.3162609788438222 \u2502  -0.0005477787062839745 \u2502\n\u2502 2015-07-01 \u2502 0.31828767677518033 \u2502   0.0020266979313581235 \u2502\n\u2502 2015-08-01 \u2502  0.3045551564286859 \u2502   -0.013732520346494415 \u2502\n\u2502 2015-09-01 \u2502   0.311221133995152 \u2502    0.006665977566466086 \u2502\n\u2502 2015-10-01 \u2502 0.30574870926812175 \u2502   -0.005472424727030245 \u2502\n\u2502 2015-11-01 \u2502 0.31125409712077234 \u2502   0.0055053878526505895 \u2502\n\u2502 2015-12-01 \u2502  0.3190967954651779 \u2502    0.007842698344405541 \u2502\n\u2502 2016-01-01 \u2502 0.32636021432496176 \u2502    0.007263418859783877 \u2502\n\n")),(0,a.kt)("p",null,"The data results show a spike in 2009. Apparently at that, time YouTube was removing their community captions feature, which allowed you to upload captions for other people's video.\nThis prompted a very successful campaign to have creators add captions to their videos for hard of hearing and deaf viewers."),(0,a.kt)("h3",{id:"top-uploaders-over-time"},"Top uploaders over time"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"WITH uploaders AS\n    (\n        SELECT uploader\n        FROM youtube\n        GROUP BY uploader\n        ORDER BY sum(view_count) DESC\n        LIMIT 10\n    )\nSELECT\n    month,\n    uploader,\n    sum(view_count) AS total_views,\n    avg(dislike_count / like_count) AS like_to_dislike_ratio\nFROM youtube\nWHERE uploader IN (uploaders)\nGROUP BY\n    toStartOfMonth(upload_date) AS month,\n    uploader\nORDER BY\n    month ASC,\n    total_views DESC\n\n1001 rows in set. Elapsed: 34.917 sec. Processed 4.58 billion rows, 69.08 GB (131.15 million rows/s., 1.98 GB/s.)\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\u250c\u2500\u2500\u2500\u2500\u2500\u2500month\u2500\u252c\u2500uploader\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500total_views\u2500\u252c\u2500like_to_dislike_ratio\u2500\u2510\n\u2502 1970-01-01 \u2502 T-Series                   \u2502    10957099 \u2502  0.022784656361208206 \u2502\n\u2502 1970-01-01 \u2502 Ryan's World               \u2502           0 \u2502  0.003035559410234172 \u2502\n\u2502 1970-01-01 \u2502 SET India                  \u2502           0 \u2502                   nan \u2502\n\u2502 2006-09-01 \u2502 Cocomelon - Nursery Rhymes \u2502   256406497 \u2502    0.7005566715978622 \u2502\n\u2502 2007-06-01 \u2502 Cocomelon - Nursery Rhymes \u2502    33641320 \u2502    0.7088650914344298 \u2502\n\u2502 2008-02-01 \u2502 WWE                        \u2502    43733469 \u2502   0.07198856488734842 \u2502\n\u2502 2008-03-01 \u2502 WWE                        \u2502    16514541 \u2502    0.1230603715431997 \u2502\n\u2502 2008-04-01 \u2502 WWE                        \u2502     5907295 \u2502    0.2089399470159618 \u2502\n\u2502 2008-05-01 \u2502 WWE                        \u2502     7779627 \u2502   0.09101676560436774 \u2502\n\u2502 2008-06-01 \u2502 WWE                        \u2502     7018780 \u2502    0.0974184753155297 \u2502\n\u2502 2008-07-01 \u2502 WWE                        \u2502     4686447 \u2502    0.1263845422065158 \u2502\n\u2502 2008-08-01 \u2502 WWE                        \u2502     4514312 \u2502   0.08384574274791441 \u2502\n\u2502 2008-09-01 \u2502 WWE                        \u2502     3717092 \u2502   0.07872802579349912 \u2502\n")),(0,a.kt)("h3",{id:"how-do-like-ratio-changes-as-views-go-up"},"How do like ratio changes as views go up?"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    concat('< ', formatReadableQuantity(view_range)) AS view_range,\n    is_comments_enabled,\n    round(like_ratio, 2) AS like_ratio\nFROM\n(\nSELECT\n    power(10, CEILING(log10(view_count + 1))) as view_range,\n    is_comments_enabled,\n    avg(like_count / dislike_count) as like_ratio\nFROM youtube WHERE dislike_count > 0\nGROUP BY\n    view_range,\n    is_comments_enabled HAVING view_range > 1\nORDER BY\n    view_range ASC,\n    is_comments_enabled ASC\n) \n\n20 rows in set. Elapsed: 9.043 sec. Processed 4.56 billion rows, 77.48 GB (503.99 million rows/s., 8.57 GB/s.)\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\n\u250c\u2500view_range\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500is_comments_enabled\u2500\u252c\u2500like_ratio\u2500\u2510\n\u2502 < 10.00           \u2502 false               \u2502       0.66 \u2502\n\u2502 < 10.00           \u2502 true                \u2502       0.66 \u2502\n\u2502 < 100.00          \u2502 false               \u2502          3 \u2502\n\u2502 < 100.00          \u2502 true                \u2502       3.95 \u2502\n\u2502 < 1.00 thousand   \u2502 false               \u2502       8.45 \u2502\n\u2502 < 1.00 thousand   \u2502 true                \u2502      13.07 \u2502\n\u2502 < 10.00 thousand  \u2502 false               \u2502      18.57 \u2502\n\u2502 < 10.00 thousand  \u2502 true                \u2502      30.92 \u2502\n\u2502 < 100.00 thousand \u2502 false               \u2502      23.55 \u2502\n\u2502 < 100.00 thousand \u2502 true                \u2502      42.13 \u2502\n\u2502 < 1.00 million    \u2502 false               \u2502      19.23 \u2502\n\u2502 < 1.00 million    \u2502 true                \u2502      37.86 \u2502\n\u2502 < 10.00 million   \u2502 false               \u2502      12.13 \u2502\n\u2502 < 10.00 million   \u2502 true                \u2502      30.72 \u2502\n\u2502 < 100.00 million  \u2502 false               \u2502       6.67 \u2502\n\u2502 < 100.00 million  \u2502 true                \u2502      23.32 \u2502\n\u2502 < 1.00 billion    \u2502 false               \u2502       3.08 \u2502\n\u2502 < 1.00 billion    \u2502 true                \u2502      20.69 \u2502\n\u2502 < 10.00 billion   \u2502 false               \u2502       1.77 \u2502\n\u2502 < 10.00 billion   \u2502 true                \u2502       19.5 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n")),(0,a.kt)("h3",{id:"how-are-views-distributed"},"How are views distributed?"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sql"},"SELECT\n    labels AS percentile,\n    round(quantiles) AS views\nFROM\n(\n    SELECT\n        quantiles(0.999, 0.99, 0.95, 0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1)(view_count) AS quantiles,\n        ['99.9th', '99th', '95th', '90th', '80th', '70th','60th', '50th', '40th', '30th', '20th', '10th'] AS labels\n    FROM youtube\n)\nARRAY JOIN\n    quantiles,\n    labels\n\n12 rows in set. Elapsed: 1.864 sec. Processed 4.56 billion rows, 36.46 GB (2.45 billion rows/s., 19.56 GB/s.)\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-response"},"\u250c\u2500percentile\u2500\u252c\u2500\u2500\u2500views\u2500\u2510\n\u2502 99.9th     \u2502 1216624 \u2502\n\u2502 99th       \u2502  143519 \u2502\n\u2502 95th       \u2502   13542 \u2502\n\u2502 90th       \u2502    4054 \u2502\n\u2502 80th       \u2502     950 \u2502\n\u2502 70th       \u2502     363 \u2502\n\u2502 60th       \u2502     177 \u2502\n\u2502 50th       \u2502      97 \u2502\n\u2502 40th       \u2502      57 \u2502\n\u2502 30th       \u2502      32 \u2502\n\u2502 20th       \u2502      16 \u2502\n\u2502 10th       \u2502       6 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n")))}p.isMDXComponent=!0}}]);